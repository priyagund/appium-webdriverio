"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.REMOTE_CACHE_ROOT = void 0;
require("source-map-support/register");
var _helpers = require("../helpers.js");
var _teen_process = require("teen_process");
var _logger = _interopRequireDefault(require("../logger.js"));
var _path = _interopRequireDefault(require("path"));
var _lodash = _interopRequireDefault(require("lodash"));
var _asyncbox = require("asyncbox");
var _support = require("@appium/support");
var _semver = _interopRequireDefault(require("semver"));
var _os = _interopRequireDefault(require("os"));
var _lruCache = _interopRequireDefault(require("lru-cache"));
var _adbkitApkreader = _interopRequireDefault(require("adbkit-apkreader"));
const apkUtilsMethods = {};
apkUtilsMethods.APP_INSTALL_STATE = {
  UNKNOWN: 'unknown',
  NOT_INSTALLED: 'notInstalled',
  NEWER_VERSION_INSTALLED: 'newerVersionInstalled',
  SAME_VERSION_INSTALLED: 'sameVersionInstalled',
  OLDER_VERSION_INSTALLED: 'olderVersionInstalled'
};
const REMOTE_CACHE_ROOT = '/data/local/tmp/appium_cache';

exports.REMOTE_CACHE_ROOT = REMOTE_CACHE_ROOT;
apkUtilsMethods.isAppInstalled = async function isAppInstalled(pkg) {
  _logger.default.debug(`Getting install status for ${pkg}`);
  const installedPattern = new RegExp(`^\\s*Package\\s+\\[${_lodash.default.escapeRegExp(pkg)}\\][^:]+:$`, 'm');
  try {
    const stdout = await this.shell(['dumpsys', 'package', pkg]);
    const isInstalled = installedPattern.test(stdout);
    _logger.default.debug(`'${pkg}' is${!isInstalled ? ' not' : ''} installed`);
    return isInstalled;
  } catch (e) {
    throw new Error(`Error finding if '${pkg}' is installed. Original error: ${e.message}`);
  }
};

apkUtilsMethods.startUri = async function startUri(uri, pkg, opts = {}) {
  const {
    waitForLaunch = true
  } = opts;
  if (!uri || !pkg) {
    throw new Error('URI and package arguments are required');
  }
  const args = ['am', 'start'];
  if (waitForLaunch) {
    args.push('-W');
  }
  args.push('-a', 'android.intent.action.VIEW', '-d', (0, _helpers.escapeShellArg)(uri), pkg);
  try {
    const res = await this.shell(args);
    if (res.toLowerCase().includes('unable to resolve intent')) {
      throw new Error(res);
    }
  } catch (e) {
    throw new Error(`Error attempting to start URI. Original error: ${e}`);
  }
};

apkUtilsMethods.startApp = async function startApp(startAppOptions = {}) {
  if (!startAppOptions.pkg || !(startAppOptions.activity || startAppOptions.action)) {
    throw new Error('pkg, and activity or intent action, are required to start an application');
  }
  startAppOptions = _lodash.default.clone(startAppOptions);
  if (startAppOptions.activity) {
    startAppOptions.activity = startAppOptions.activity.replace('$', '\\$');
  }
  _lodash.default.defaults(startAppOptions, {
    waitPkg: startAppOptions.pkg,
    waitForLaunch: true,
    waitActivity: false,
    retry: true,
    stopApp: true
  });
  startAppOptions.waitPkg = startAppOptions.waitPkg || startAppOptions.pkg;
  const apiLevel = await this.getApiLevel();
  const cmd = (0, _helpers.buildStartCmd)(startAppOptions, apiLevel);
  const intentName = `${startAppOptions.action}${startAppOptions.optionalIntentArguments ? ' ' + startAppOptions.optionalIntentArguments : ''}`;
  try {
    const shellOpts = {};
    if (_lodash.default.isInteger(startAppOptions.waitDuration) && startAppOptions.waitDuration >= 0) {
      shellOpts.timeout = startAppOptions.waitDuration;
    }
    const stdout = await this.shell(cmd, shellOpts);
    if (stdout.includes('Error: Activity class') && stdout.includes('does not exist')) {
      if (startAppOptions.retry && !startAppOptions.activity.startsWith('.')) {
        _logger.default.debug(`We tried to start an activity that doesn't exist, ` + `retrying with '.${startAppOptions.activity}' activity name`);
        startAppOptions.activity = `.${startAppOptions.activity}`;
        startAppOptions.retry = false;
        return await this.startApp(startAppOptions);
      }
      throw new Error(`Activity name '${startAppOptions.activity}' used to start the app doesn't ` + `exist or cannot be launched! Make sure it exists and is a launchable activity`);
    } else if (stdout.includes('Error: Intent does not match any activities') || stdout.includes('Error: Activity not started, unable to resolve Intent')) {
      throw new Error(`Activity for intent '${intentName}' used to start the app doesn't ` + `exist or cannot be launched! Make sure it exists and is a launchable activity`);
    } else if (stdout.includes('java.lang.SecurityException')) {
      throw new Error(`The permission to start '${startAppOptions.activity}' activity has been denied.` + `Make sure the activity/package names are correct.`);
    }
    if (startAppOptions.waitActivity) {
      await this.waitForActivity(startAppOptions.waitPkg, startAppOptions.waitActivity, startAppOptions.waitDuration);
    }
    return stdout;
  } catch (e) {
    const appDescriptor = startAppOptions.pkg || intentName;
    throw new Error(`Cannot start the '${appDescriptor}' application. ` + `Consider checking the driver's troubleshooting documentation. ` + `Original error: ${e.message}`);
  }
};

apkUtilsMethods.dumpWindows = async function dumpWindows() {
  const apiLevel = await this.getApiLevel();

  const dumpsysArg = apiLevel >= 29 ? 'displays' : 'windows';
  const cmd = ['dumpsys', 'window', dumpsysArg];
  return await this.shell(cmd);
};

apkUtilsMethods.getFocusedPackageAndActivity = async function getFocusedPackageAndActivity() {
  _logger.default.debug('Getting focused package and activity');
  let stdout;
  try {
    stdout = await this.dumpWindows();
  } catch (e) {
    throw new Error(`Could not retrieve the currently focused package and activity. Original error: ${e.message}`);
  }
  const nullFocusedAppRe = /^\s*mFocusedApp=null/m;
  const focusedAppRe = new RegExp('^\\s*mFocusedApp.+Record\\{.*\\s([^\\s\\/\\}]+)\\/([^\\s\\/\\}\\,]+)\\,?(\\s[^\\s\\/\\}]+)*\\}', 'mg');
  const nullCurrentFocusRe = /^\s*mCurrentFocus=null/m;
  const currentFocusAppRe = new RegExp('^\\s*mCurrentFocus.+\\{.+\\s([^\\s\\/]+)\\/([^\\s]+)\\b', 'mg');
  const focusedAppCandidates = [];
  const currentFocusAppCandidates = [];
  for (const [candidates, pattern] of [[focusedAppCandidates, focusedAppRe], [currentFocusAppCandidates, currentFocusAppRe]]) {
    let match;
    while (match = pattern.exec(stdout)) {
      candidates.push({
        appPackage: match[1].trim(),
        appActivity: match[2].trim()
      });
    }
  }
  if (focusedAppCandidates.length > 1 && currentFocusAppCandidates.length > 0) {
    return _lodash.default.intersectionWith(focusedAppCandidates, currentFocusAppCandidates, _lodash.default.isEqual)[0] ?? focusedAppCandidates[0];
  }
  if (focusedAppCandidates.length > 0 || currentFocusAppCandidates.length > 0) {
    return focusedAppCandidates[0] ?? currentFocusAppCandidates[0];
  }
  for (const pattern of [nullFocusedAppRe, nullCurrentFocusRe]) {
    if (pattern.exec(stdout)) {
      return {
        appPackage: null,
        appActivity: null
      };
    }
  }
  _logger.default.debug(stdout);
  throw new Error('Could not retrieve the currently focused package and activity');
};

apkUtilsMethods.waitForActivityOrNot = async function waitForActivityOrNot(pkg, activity, waitForStop, waitMs = 20000) {
  if (!pkg || !activity) {
    throw new Error('Package and activity required.');
  }
  _logger.default.debug(`Waiting up to ${waitMs}ms for activity matching pkg: '${pkg}' and ` + `activity: '${activity}' to${waitForStop ? ' not' : ''} be focused`);
  const splitNames = names => names.split(',').map(name => name.trim());
  const allPackages = splitNames(pkg);
  const allActivities = splitNames(activity);
  const possibleActivityNames = [];
  for (const oneActivity of allActivities) {
    if (oneActivity.startsWith('.')) {
      for (const currentPkg of allPackages) {
        possibleActivityNames.push(`${currentPkg}${oneActivity}`.replace(/\.+/g, '.'));
      }
    } else {
      possibleActivityNames.push(oneActivity);
      possibleActivityNames.push(`${pkg}.${oneActivity}`);
    }
  }
  _logger.default.debug(`Possible activities, to be checked: ${possibleActivityNames.map(name => `'${name}'`).join(', ')}`);
  const possibleActivityPatterns = possibleActivityNames.map(actName => new RegExp(`^${actName.replace(/\./g, '\\.').replace(/\*/g, '.*?').replace(/\$/g, '\\$')}$`));
  const conditionFunc = async () => {
    let appPackage;
    let appActivity;
    try {
      ({
        appPackage,
        appActivity
      } = await this.getFocusedPackageAndActivity());
    } catch (e) {
      _logger.default.debug(e.message);
      return false;
    }
    if (appActivity && appPackage) {
      const fullyQualifiedActivity = appActivity.startsWith('.') ? `${appPackage}${appActivity}` : appActivity;
      _logger.default.debug(`Found package: '${appPackage}' and fully qualified activity name : '${fullyQualifiedActivity}'`);
      const isActivityFound = _lodash.default.includes(allPackages, appPackage) && possibleActivityPatterns.some(p => p.test(fullyQualifiedActivity));
      if (!waitForStop && isActivityFound || waitForStop && !isActivityFound) {
        return true;
      }
    }
    _logger.default.debug('Incorrect package and activity. Retrying.');
    return false;
  };
  try {
    await (0, _asyncbox.waitForCondition)(conditionFunc, {
      waitMs: parseInt(waitMs, 10),
      intervalMs: 500
    });
  } catch (e) {
    throw new Error(`${possibleActivityNames.map(name => `'${name}'`).join(' or ')} never ${waitForStop ? 'stopped' : 'started'}. ` + `Consider checking the driver's troubleshooting documentation.`);
  }
};

apkUtilsMethods.waitForActivity = async function waitForActivity(pkg, act, waitMs = 20000) {
  await this.waitForActivityOrNot(pkg, act, false, waitMs);
};

apkUtilsMethods.waitForNotActivity = async function waitForNotActivity(pkg, act, waitMs = 20000) {
  await this.waitForActivityOrNot(pkg, act, true, waitMs);
};

apkUtilsMethods.uninstallApk = async function uninstallApk(pkg, options = {}) {
  _logger.default.debug(`Uninstalling ${pkg}`);
  if (!(await this.isAppInstalled(pkg))) {
    _logger.default.info(`${pkg} was not uninstalled, because it was not present on the device`);
    return false;
  }
  const cmd = ['uninstall'];
  if (options.keepData) {
    cmd.push('-k');
  }
  cmd.push(pkg);
  let stdout;
  try {
    await this.forceStop(pkg);
    stdout = (await this.adbExec(cmd, {
      timeout: options.timeout
    })).trim();
  } catch (e) {
    throw new Error(`Unable to uninstall APK. Original error: ${e.message}`);
  }
  _logger.default.debug(`'adb ${cmd.join(' ')}' command output: ${stdout}`);
  if (stdout.includes('Success')) {
    _logger.default.info(`${pkg} was successfully uninstalled`);
    return true;
  }
  _logger.default.info(`${pkg} was not uninstalled`);
  return false;
};

apkUtilsMethods.installFromDevicePath = async function installFromDevicePath(apkPathOnDevice, opts = {}) {
  let stdout = await this.shell(['pm', 'install', '-r', apkPathOnDevice], opts);
  if (stdout.indexOf('Failure') !== -1) {
    throw new Error(`Remote install failed: ${stdout}`);
  }
};

apkUtilsMethods.cacheApk = async function cacheApk(apkPath, options = {}) {
  const appHash = await _support.fs.hash(apkPath);
  const remotePath = _path.default.posix.join(REMOTE_CACHE_ROOT, `${appHash}.apk`);
  const remoteCachedFiles = [];
  try {
    const errorMarker = '_ERROR_';
    let lsOutput = null;
    if (this._areExtendedLsOptionsSupported === true || !_lodash.default.isBoolean(this._areExtendedLsOptionsSupported)) {
      lsOutput = await this.shell([`ls -t -1 ${REMOTE_CACHE_ROOT} 2>&1 || echo ${errorMarker}`]);
    }
    if (!_lodash.default.isString(lsOutput) || lsOutput.includes(errorMarker) && !lsOutput.includes(REMOTE_CACHE_ROOT)) {
      if (!_lodash.default.isBoolean(this._areExtendedLsOptionsSupported)) {
        _logger.default.debug('The current Android API does not support extended ls options. ' + 'Defaulting to no-options call');
      }
      lsOutput = await this.shell([`ls ${REMOTE_CACHE_ROOT} 2>&1 || echo ${errorMarker}`]);
      this._areExtendedLsOptionsSupported = false;
    } else {
      this._areExtendedLsOptionsSupported = true;
    }
    if (lsOutput.includes(errorMarker)) {
      throw new Error(lsOutput.substring(0, lsOutput.indexOf(errorMarker)));
    }
    remoteCachedFiles.push(...lsOutput.split('\n').map(x => x.trim()).filter(Boolean));
  } catch (e) {
    _logger.default.debug(`Got an error '${e.message.trim()}' while getting the list of files in the cache. ` + `Assuming the cache does not exist yet`);
    await this.shell(['mkdir', '-p', REMOTE_CACHE_ROOT]);
  }
  _logger.default.debug(`The count of applications in the cache: ${remoteCachedFiles.length}`);
  const toHash = remotePath => _path.default.posix.parse(remotePath).name;
  if (remoteCachedFiles.some(x => toHash(x) === appHash)) {
    _logger.default.info(`The application at '${apkPath}' is already cached to '${remotePath}'`);
    this.shell(['touch', '-am', remotePath]).catch(() => {});
  } else {
    _logger.default.info(`Caching the application at '${apkPath}' to '${remotePath}'`);
    const timer = new _support.timing.Timer().start();
    await this.push(apkPath, remotePath, {
      timeout: options.timeout
    });
    const {
      size
    } = await _support.fs.stat(apkPath);
    _logger.default.info(`The upload of '${_path.default.basename(apkPath)}' (${_support.util.toReadableSizeString(size)}) ` + `took ${timer.getDuration().asMilliSeconds.toFixed(0)}ms`);
  }
  if (!this.remoteAppsCache) {
    this.remoteAppsCache = new _lruCache.default({
      max: this.remoteAppsCacheLimit
    });
  }
  _lodash.default.difference([...this.remoteAppsCache.keys()], remoteCachedFiles.map(toHash)).forEach(hash => this.remoteAppsCache.del(hash));
  this.remoteAppsCache.set(appHash, remotePath);
  const entriesToCleanup = remoteCachedFiles.map(x => _path.default.posix.join(REMOTE_CACHE_ROOT, x)).filter(x => !this.remoteAppsCache.has(toHash(x))).slice(this.remoteAppsCacheLimit - [...this.remoteAppsCache.keys()].length);
  if (!_lodash.default.isEmpty(entriesToCleanup)) {
    try {
      await this.shell(['rm', '-f', ...entriesToCleanup]);
      _logger.default.debug(`Deleted ${entriesToCleanup.length} expired application cache entries`);
    } catch (e) {
      _logger.default.warn(`Cannot delete ${entriesToCleanup.length} expired application cache entries. ` + `Original error: ${e.message}`);
    }
  }
  return remotePath;
};

apkUtilsMethods.install = async function install(appPath, options = {}) {
  if (appPath.endsWith(_helpers.APKS_EXTENSION)) {
    return await this.installApks(appPath, options);
  }
  options = _lodash.default.cloneDeep(options);
  _lodash.default.defaults(options, {
    replace: true,
    timeout: this.adbExecTimeout === _helpers.DEFAULT_ADB_EXEC_TIMEOUT ? _helpers.APK_INSTALL_TIMEOUT : this.adbExecTimeout,
    timeoutCapName: 'androidInstallTimeout'
  });
  const installArgs = (0, _helpers.buildInstallArgs)(await this.getApiLevel(), options);
  if (options.noIncremental && (await this.isIncrementalInstallSupported())) {
    installArgs.push('--no-incremental');
  }
  const installOpts = {
    timeout: options.timeout,
    timeoutCapName: options.timeoutCapName
  };
  const installCmd = ['install', ...installArgs, appPath];
  let performAppInstall = async () => await this.adbExec(installCmd, installOpts);
  let shouldCacheApp = this.remoteAppsCacheLimit > 0;
  if (shouldCacheApp) {
    shouldCacheApp = !(await this.isStreamedInstallSupported());
    if (!shouldCacheApp) {
      _logger.default.info(`The application at '${appPath}' will not be cached, because the device under test has ` + `confirmed the support of streamed installs`);
    }
  }
  if (shouldCacheApp) {
    const clearCache = async () => {
      _logger.default.info(`Clearing the cache at '${REMOTE_CACHE_ROOT}'`);
      await this.shell(['rm', '-rf', `${REMOTE_CACHE_ROOT}/*`]);
    };
    const cacheApp = async () => await this.cacheApk(appPath, {
      timeout: options.timeout
    });
    try {
      const cachedAppPath = await cacheApp();
      performAppInstall = async () => {
        const pmInstallCmdByRemotePath = remotePath => ['pm', 'install', ...installArgs, remotePath];
        const output = await this.shell(pmInstallCmdByRemotePath(cachedAppPath), installOpts);
        if (/\bINSTALL_FAILED_INSUFFICIENT_STORAGE\b/.test(output)) {
          _logger.default.warn(`There was a failure while installing '${appPath}' ` + `because of the insufficient device storage space`);
          await clearCache();
          _logger.default.info(`Consider decreasing the maximum amount of cached apps ` + `(currently ${this.remoteAppsCacheLimit}) to avoid such issues in the future`);
          const newCachedAppPath = await cacheApp();
          return await this.shell(pmInstallCmdByRemotePath(newCachedAppPath), installOpts);
        }
        return output;
      };
    } catch (e) {
      _logger.default.debug(e);
      _logger.default.warn(`There was a failure while caching '${appPath}': ${e.message}`);
      _logger.default.warn('Falling back to the default installation procedure');
      await clearCache();
    }
  }
  try {
    const timer = new _support.timing.Timer().start();
    const output = await performAppInstall();
    _logger.default.info(`The installation of '${_path.default.basename(appPath)}' took ${timer.getDuration().asMilliSeconds.toFixed(0)}ms`);
    const truncatedOutput = !_lodash.default.isString(output) || output.length <= 300 ? output : `${output.substr(0, 150)}...${output.substr(output.length - 150)}`;
    _logger.default.debug(`Install command stdout: ${truncatedOutput}`);
    if (/\[INSTALL[A-Z_]+FAILED[A-Z_]+\]/.test(output)) {
      if (this.isTestPackageOnlyError(output)) {
        const msg = `Set 'allowTestPackages' capability to true in order to allow test packages installation.`;
        _logger.default.warn(msg);
        throw new Error(`${output}\n${msg}`);
      }
      throw new Error(output);
    }
  } catch (err) {
    if (!err.message.includes('INSTALL_FAILED_ALREADY_EXISTS')) {
      throw err;
    }
    _logger.default.debug(`Application '${appPath}' already installed. Continuing.`);
  }
};

apkUtilsMethods.getApplicationInstallState = async function getApplicationInstallState(appPath, pkg = null) {
  let apkInfo = null;
  if (!pkg) {
    apkInfo = await this.getApkInfo(appPath);
    pkg = apkInfo.name;
  }
  if (!pkg) {
    _logger.default.warn(`Cannot read the package name of '${appPath}'`);
    return this.APP_INSTALL_STATE.UNKNOWN;
  }
  if (!(await this.isAppInstalled(pkg))) {
    _logger.default.debug(`App '${appPath}' is not installed`);
    return this.APP_INSTALL_STATE.NOT_INSTALLED;
  }
  const {
    versionCode: pkgVersionCode,
    versionName: pkgVersionNameStr
  } = await this.getPackageInfo(pkg);
  const pkgVersionName = _semver.default.valid(_semver.default.coerce(pkgVersionNameStr));
  if (!apkInfo) {
    apkInfo = await this.getApkInfo(appPath);
  }
  const {
    versionCode: apkVersionCode,
    versionName: apkVersionNameStr
  } = apkInfo;
  const apkVersionName = _semver.default.valid(_semver.default.coerce(apkVersionNameStr));
  if (!_lodash.default.isInteger(apkVersionCode) || !_lodash.default.isInteger(pkgVersionCode)) {
    _logger.default.warn(`Cannot read version codes of '${appPath}' and/or '${pkg}'`);
    if (!_lodash.default.isString(apkVersionName) || !_lodash.default.isString(pkgVersionName)) {
      _logger.default.warn(`Cannot read version names of '${appPath}' and/or '${pkg}'`);
      return this.APP_INSTALL_STATE.UNKNOWN;
    }
  }
  if (_lodash.default.isInteger(apkVersionCode) && _lodash.default.isInteger(pkgVersionCode)) {
    if (pkgVersionCode > apkVersionCode) {
      _logger.default.debug(`The version code of the installed '${pkg}' is greater than the application version code (${pkgVersionCode} > ${apkVersionCode})`);
      return this.APP_INSTALL_STATE.NEWER_VERSION_INSTALLED;
    }
    if (pkgVersionCode === apkVersionCode) {
      if (_lodash.default.isString(apkVersionName) && _lodash.default.isString(pkgVersionName) && _semver.default.satisfies(pkgVersionName, `>=${apkVersionName}`)) {
        _logger.default.debug(`The version name of the installed '${pkg}' is greater or equal to the application version name ('${pkgVersionName}' >= '${apkVersionName}')`);
        return _semver.default.satisfies(pkgVersionName, `>${apkVersionName}`) ? this.APP_INSTALL_STATE.NEWER_VERSION_INSTALLED : this.APP_INSTALL_STATE.SAME_VERSION_INSTALLED;
      }
      if (!_lodash.default.isString(apkVersionName) || !_lodash.default.isString(pkgVersionName)) {
        _logger.default.debug(`The version name of the installed '${pkg}' is equal to application version name (${pkgVersionCode} === ${apkVersionCode})`);
        return this.APP_INSTALL_STATE.SAME_VERSION_INSTALLED;
      }
    }
  } else if (_lodash.default.isString(apkVersionName) && _lodash.default.isString(pkgVersionName) && _semver.default.satisfies(pkgVersionName, `>=${apkVersionName}`)) {
    _logger.default.debug(`The version name of the installed '${pkg}' is greater or equal to the application version name ('${pkgVersionName}' >= '${apkVersionName}')`);
    return _semver.default.satisfies(pkgVersionName, `>${apkVersionName}`) ? this.APP_INSTALL_STATE.NEWER_VERSION_INSTALLED : this.APP_INSTALL_STATE.SAME_VERSION_INSTALLED;
  }
  _logger.default.debug(`The installed '${pkg}' package is older than '${appPath}' (${pkgVersionCode} < ${apkVersionCode} or '${pkgVersionName}' < '${apkVersionName}')'`);
  return this.APP_INSTALL_STATE.OLDER_VERSION_INSTALLED;
};

apkUtilsMethods.installOrUpgrade = async function installOrUpgrade(appPath, pkg = null, options = {}) {
  if (!pkg) {
    const apkInfo = await this.getApkInfo(appPath);
    pkg = apkInfo.name;
  }
  const {
    enforceCurrentBuild
  } = options;
  const appState = await this.getApplicationInstallState(appPath, pkg);
  let wasUninstalled = false;
  const uninstallPackage = async () => {
    if (!(await this.uninstallApk(pkg))) {
      throw new Error(`'${pkg}' package cannot be uninstalled`);
    }
    wasUninstalled = true;
  };
  switch (appState) {
    case this.APP_INSTALL_STATE.NOT_INSTALLED:
      _logger.default.debug(`Installing '${appPath}'`);
      await this.install(appPath, Object.assign({}, options, {
        replace: false
      }));
      return {
        appState,
        wasUninstalled
      };
    case this.APP_INSTALL_STATE.NEWER_VERSION_INSTALLED:
      if (enforceCurrentBuild) {
        _logger.default.info(`Downgrading '${pkg}' as requested`);
        await uninstallPackage();
        break;
      }
      _logger.default.debug(`There is no need to downgrade '${pkg}'`);
      return {
        appState,
        wasUninstalled
      };
    case this.APP_INSTALL_STATE.SAME_VERSION_INSTALLED:
      if (enforceCurrentBuild) {
        break;
      }
      _logger.default.debug(`There is no need to install/upgrade '${appPath}'`);
      return {
        appState,
        wasUninstalled
      };
    case this.APP_INSTALL_STATE.OLDER_VERSION_INSTALLED:
      _logger.default.debug(`Executing upgrade of '${appPath}'`);
      break;
    default:
      _logger.default.debug(`The current install state of '${appPath}' is unknown. Installing anyway`);
      break;
  }
  try {
    await this.install(appPath, Object.assign({}, options, {
      replace: true
    }));
  } catch (err) {
    _logger.default.warn(`Cannot install/upgrade '${pkg}' because of '${err.message}'. Trying full reinstall`);
    await uninstallPackage();
    await this.install(appPath, Object.assign({}, options, {
      replace: false
    }));
  }
  return {
    appState,
    wasUninstalled
  };
};

apkUtilsMethods.extractStringsFromApk = async function extractStringsFromApk(appPath, language, out) {
  _logger.default.debug(`Extracting strings from for language: ${language || 'default'}`);
  const originalAppPath = appPath;
  if (appPath.endsWith(_helpers.APKS_EXTENSION)) {
    appPath = await this.extractLanguageApk(appPath, language);
  }
  let apkStrings = {};
  let configMarker;
  try {
    await this.initAapt();
    configMarker = await (0, _helpers.formatConfigMarker)(async () => {
      const {
        stdout
      } = await (0, _teen_process.exec)(this.binaries.aapt, ['d', 'configurations', appPath]);
      return _lodash.default.uniq(stdout.split(_os.default.EOL));
    }, language, '(default)');
    const {
      stdout
    } = await (0, _teen_process.exec)(this.binaries.aapt, ['d', '--values', 'resources', appPath]);
    apkStrings = (0, _helpers.parseAaptStrings)(stdout, configMarker);
  } catch (e) {
    _logger.default.debug('Cannot extract resources using aapt. Trying aapt2. ' + `Original error: ${e.stderr || e.message}`);
    await this.initAapt2();
    configMarker = await (0, _helpers.formatConfigMarker)(async () => {
      const {
        stdout
      } = await (0, _teen_process.exec)(this.binaries.aapt2, ['d', 'configurations', appPath]);
      return _lodash.default.uniq(stdout.split(_os.default.EOL));
    }, language, '');
    try {
      const {
        stdout
      } = await (0, _teen_process.exec)(this.binaries.aapt2, ['d', 'resources', appPath]);
      apkStrings = (0, _helpers.parseAapt2Strings)(stdout, configMarker);
    } catch (e) {
      throw new Error(`Cannot extract resources from '${originalAppPath}'. ` + `Original error: ${e.message}`);
    }
  }
  if (_lodash.default.isEmpty(apkStrings)) {
    _logger.default.warn(`No strings have been found in '${originalAppPath}' resources ` + `for '${configMarker || 'default'}' configuration`);
  } else {
    _logger.default.info(`Successfully extracted ${_lodash.default.keys(apkStrings).length} strings from ` + `'${originalAppPath}' resources for '${configMarker || 'default'}' configuration`);
  }
  const localPath = _path.default.resolve(out, 'strings.json');
  await (0, _support.mkdirp)(out);
  await _support.fs.writeFile(localPath, JSON.stringify(apkStrings, null, 2), 'utf-8');
  return {
    apkStrings,
    localPath
  };
};

apkUtilsMethods.getDeviceLanguage = async function getDeviceLanguage() {
  let language;
  if ((await this.getApiLevel()) < 23) {
    language = await this.getDeviceSysLanguage();
    if (!language) {
      language = await this.getDeviceProductLanguage();
    }
  } else {
    language = (await this.getDeviceLocale()).split('-')[0];
  }
  return language;
};

apkUtilsMethods.getDeviceCountry = async function getDeviceCountry() {
  let country = await this.getDeviceSysCountry();
  if (!country) {
    country = await this.getDeviceProductCountry();
  }
  return country;
};

apkUtilsMethods.getDeviceLocale = async function getDeviceLocale() {
  let locale = await this.getDeviceSysLocale();
  if (!locale) {
    locale = await this.getDeviceProductLocale();
  }
  return locale;
};

apkUtilsMethods.setDeviceLocale = async function setDeviceLocale(locale) {
  const validateLocale = new RegExp(/[a-zA-Z]+-[a-zA-Z0-9]+/);
  if (!validateLocale.test(locale)) {
    _logger.default.warn(`setDeviceLocale requires the following format: en-US or ja-JP`);
    return;
  }
  let split_locale = locale.split('-');
  await this.setDeviceLanguageCountry(split_locale[0], split_locale[1]);
};

apkUtilsMethods.ensureCurrentLocale = async function ensureCurrentLocale(language, country, script = null) {
  const hasLanguage = _lodash.default.isString(language);
  const hasCountry = _lodash.default.isString(country);
  if (!hasLanguage && !hasCountry) {
    _logger.default.warn('ensureCurrentLocale requires language or country');
    return false;
  }

  language = (language || '').toLowerCase();
  country = (country || '').toLowerCase();
  const apiLevel = await this.getApiLevel();
  return await (0, _asyncbox.retryInterval)(5, 1000, async () => {
    try {
      if (apiLevel < 23) {
        let curLanguage, curCountry;
        if (hasLanguage) {
          curLanguage = (await this.getDeviceLanguage()).toLowerCase();
          if (!hasCountry && language === curLanguage) {
            return true;
          }
        }
        if (hasCountry) {
          curCountry = (await this.getDeviceCountry()).toLowerCase();
          if (!hasLanguage && country === curCountry) {
            return true;
          }
        }
        if (language === curLanguage && country === curCountry) {
          return true;
        }
      } else {
        const curLocale = (await this.getDeviceLocale()).toLowerCase();
        const localeCode = script ? `${language}-${script.toLowerCase()}-${country}` : `${language}-${country}`;
        if (localeCode === curLocale) {
          _logger.default.debug(`Requested locale is equal to current locale: '${curLocale}'`);
          return true;
        }
      }
      return false;
    } catch (err) {
      _logger.default.error(`Unable to check device localization: ${err.message}`);
      try {
        await this.reconnect();
      } catch (ign) {
        await this.restartAdb();
      }
      throw err;
    }
  });
};

apkUtilsMethods.setDeviceLanguageCountry = async function setDeviceLanguageCountry(language, country, script = null) {
  let hasLanguage = language && _lodash.default.isString(language);
  let hasCountry = country && _lodash.default.isString(country);
  if (!hasLanguage || !hasCountry) {
    _logger.default.warn(`setDeviceLanguageCountry requires language and country at least`);
    _logger.default.warn(`Got language: '${language}' and country: '${country}'`);
    return;
  }
  let apiLevel = await this.getApiLevel();
  language = (language || '').toLowerCase();
  country = (country || '').toUpperCase();
  if (apiLevel < 23) {
    let curLanguage = (await this.getDeviceLanguage()).toLowerCase();
    let curCountry = (await this.getDeviceCountry()).toUpperCase();
    if (language !== curLanguage || country !== curCountry) {
      await this.setDeviceSysLocaleViaSettingApp(language, country);
    }
  } else {
    let curLocale = await this.getDeviceLocale();

    const localeCode = script ? `${language}-${script}-${country}` : `${language}-${country}`;
    _logger.default.debug(`Current locale: '${curLocale}'; requested locale: '${localeCode}'`);
    if (localeCode.toLowerCase() !== curLocale.toLowerCase()) {
      await this.setDeviceSysLocaleViaSettingApp(language, country, script);
    }
  }
};

apkUtilsMethods.getApkInfo = async function getApkInfo(appPath) {
  if (!(await _support.fs.exists(appPath))) {
    throw new Error(`The file at path ${appPath} does not exist or is not accessible`);
  }
  if (appPath.endsWith(_helpers.APKS_EXTENSION)) {
    appPath = await this.extractBaseApk(appPath);
  }
  try {
    const apkReader = await _adbkitApkreader.default.open(appPath);
    const manifest = await apkReader.readManifest();
    const {
      pkg,
      versionName,
      versionCode
    } = (0, _helpers.parseManifest)(manifest);
    return {
      name: pkg,
      versionCode,
      versionName
    };
  } catch (e) {
    _logger.default.warn(`Error '${e.message}' while getting badging info`);
  }
  return {};
};

apkUtilsMethods.getPackageInfo = async function getPackageInfo(pkg) {
  _logger.default.debug(`Getting package info for '${pkg}'`);
  let result = {
    name: pkg
  };
  try {
    const stdout = await this.shell(['dumpsys', 'package', pkg]);
    const versionNameMatch = new RegExp(/versionName=([\d+.]+)/).exec(stdout);
    if (versionNameMatch) {
      result.versionName = versionNameMatch[1];
    }
    const versionCodeMatch = new RegExp(/versionCode=(\d+)/).exec(stdout);
    if (versionCodeMatch) {
      result.versionCode = parseInt(versionCodeMatch[1], 10);
    }
    return result;
  } catch (err) {
    _logger.default.warn(`Error '${err.message}' while dumping package info`);
  }
  return result;
};

apkUtilsMethods.pullApk = async function pullApk(pkg, tmpDir) {
  const stdout = _lodash.default.trim(await this.shell(['pm', 'path', pkg]));
  const packageMarker = 'package:';
  if (!_lodash.default.startsWith(stdout, packageMarker)) {
    throw new Error(`Cannot pull the .apk package for '${pkg}'. Original error: ${stdout}`);
  }
  const remotePath = stdout.replace(packageMarker, '');
  const tmpApp = _path.default.resolve(tmpDir, `${pkg}.apk`);
  await this.pull(remotePath, tmpApp);
  _logger.default.debug(`Pulled app for package '${pkg}' to '${tmpApp}'`);
  return tmpApp;
};
var _default = apkUtilsMethods;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJhcGtVdGlsc01ldGhvZHMiLCJBUFBfSU5TVEFMTF9TVEFURSIsIlVOS05PV04iLCJOT1RfSU5TVEFMTEVEIiwiTkVXRVJfVkVSU0lPTl9JTlNUQUxMRUQiLCJTQU1FX1ZFUlNJT05fSU5TVEFMTEVEIiwiT0xERVJfVkVSU0lPTl9JTlNUQUxMRUQiLCJSRU1PVEVfQ0FDSEVfUk9PVCIsImlzQXBwSW5zdGFsbGVkIiwicGtnIiwibG9nIiwiZGVidWciLCJpbnN0YWxsZWRQYXR0ZXJuIiwiUmVnRXhwIiwiXyIsImVzY2FwZVJlZ0V4cCIsInN0ZG91dCIsInNoZWxsIiwiaXNJbnN0YWxsZWQiLCJ0ZXN0IiwiZSIsIkVycm9yIiwibWVzc2FnZSIsInN0YXJ0VXJpIiwidXJpIiwib3B0cyIsIndhaXRGb3JMYXVuY2giLCJhcmdzIiwicHVzaCIsImVzY2FwZVNoZWxsQXJnIiwicmVzIiwidG9Mb3dlckNhc2UiLCJpbmNsdWRlcyIsInN0YXJ0QXBwIiwic3RhcnRBcHBPcHRpb25zIiwiYWN0aXZpdHkiLCJhY3Rpb24iLCJjbG9uZSIsInJlcGxhY2UiLCJkZWZhdWx0cyIsIndhaXRQa2ciLCJ3YWl0QWN0aXZpdHkiLCJyZXRyeSIsInN0b3BBcHAiLCJhcGlMZXZlbCIsImdldEFwaUxldmVsIiwiY21kIiwiYnVpbGRTdGFydENtZCIsImludGVudE5hbWUiLCJvcHRpb25hbEludGVudEFyZ3VtZW50cyIsInNoZWxsT3B0cyIsImlzSW50ZWdlciIsIndhaXREdXJhdGlvbiIsInRpbWVvdXQiLCJzdGFydHNXaXRoIiwid2FpdEZvckFjdGl2aXR5IiwiYXBwRGVzY3JpcHRvciIsImR1bXBXaW5kb3dzIiwiZHVtcHN5c0FyZyIsImdldEZvY3VzZWRQYWNrYWdlQW5kQWN0aXZpdHkiLCJudWxsRm9jdXNlZEFwcFJlIiwiZm9jdXNlZEFwcFJlIiwibnVsbEN1cnJlbnRGb2N1c1JlIiwiY3VycmVudEZvY3VzQXBwUmUiLCJmb2N1c2VkQXBwQ2FuZGlkYXRlcyIsImN1cnJlbnRGb2N1c0FwcENhbmRpZGF0ZXMiLCJjYW5kaWRhdGVzIiwicGF0dGVybiIsIm1hdGNoIiwiZXhlYyIsImFwcFBhY2thZ2UiLCJ0cmltIiwiYXBwQWN0aXZpdHkiLCJsZW5ndGgiLCJpbnRlcnNlY3Rpb25XaXRoIiwiaXNFcXVhbCIsIndhaXRGb3JBY3Rpdml0eU9yTm90Iiwid2FpdEZvclN0b3AiLCJ3YWl0TXMiLCJzcGxpdE5hbWVzIiwibmFtZXMiLCJzcGxpdCIsIm1hcCIsIm5hbWUiLCJhbGxQYWNrYWdlcyIsImFsbEFjdGl2aXRpZXMiLCJwb3NzaWJsZUFjdGl2aXR5TmFtZXMiLCJvbmVBY3Rpdml0eSIsImN1cnJlbnRQa2ciLCJqb2luIiwicG9zc2libGVBY3Rpdml0eVBhdHRlcm5zIiwiYWN0TmFtZSIsImNvbmRpdGlvbkZ1bmMiLCJmdWxseVF1YWxpZmllZEFjdGl2aXR5IiwiaXNBY3Rpdml0eUZvdW5kIiwic29tZSIsInAiLCJ3YWl0Rm9yQ29uZGl0aW9uIiwicGFyc2VJbnQiLCJpbnRlcnZhbE1zIiwiYWN0Iiwid2FpdEZvck5vdEFjdGl2aXR5IiwidW5pbnN0YWxsQXBrIiwib3B0aW9ucyIsImluZm8iLCJrZWVwRGF0YSIsImZvcmNlU3RvcCIsImFkYkV4ZWMiLCJpbnN0YWxsRnJvbURldmljZVBhdGgiLCJhcGtQYXRoT25EZXZpY2UiLCJpbmRleE9mIiwiY2FjaGVBcGsiLCJhcGtQYXRoIiwiYXBwSGFzaCIsImZzIiwiaGFzaCIsInJlbW90ZVBhdGgiLCJwYXRoIiwicG9zaXgiLCJyZW1vdGVDYWNoZWRGaWxlcyIsImVycm9yTWFya2VyIiwibHNPdXRwdXQiLCJfYXJlRXh0ZW5kZWRMc09wdGlvbnNTdXBwb3J0ZWQiLCJpc0Jvb2xlYW4iLCJpc1N0cmluZyIsInN1YnN0cmluZyIsIngiLCJmaWx0ZXIiLCJCb29sZWFuIiwidG9IYXNoIiwicGFyc2UiLCJjYXRjaCIsInRpbWVyIiwidGltaW5nIiwiVGltZXIiLCJzdGFydCIsInNpemUiLCJzdGF0IiwiYmFzZW5hbWUiLCJ1dGlsIiwidG9SZWFkYWJsZVNpemVTdHJpbmciLCJnZXREdXJhdGlvbiIsImFzTWlsbGlTZWNvbmRzIiwidG9GaXhlZCIsInJlbW90ZUFwcHNDYWNoZSIsIkxSVSIsIm1heCIsInJlbW90ZUFwcHNDYWNoZUxpbWl0IiwiZGlmZmVyZW5jZSIsImtleXMiLCJmb3JFYWNoIiwiZGVsIiwic2V0IiwiZW50cmllc1RvQ2xlYW51cCIsImhhcyIsInNsaWNlIiwiaXNFbXB0eSIsIndhcm4iLCJpbnN0YWxsIiwiYXBwUGF0aCIsImVuZHNXaXRoIiwiQVBLU19FWFRFTlNJT04iLCJpbnN0YWxsQXBrcyIsImNsb25lRGVlcCIsImFkYkV4ZWNUaW1lb3V0IiwiREVGQVVMVF9BREJfRVhFQ19USU1FT1VUIiwiQVBLX0lOU1RBTExfVElNRU9VVCIsInRpbWVvdXRDYXBOYW1lIiwiaW5zdGFsbEFyZ3MiLCJidWlsZEluc3RhbGxBcmdzIiwibm9JbmNyZW1lbnRhbCIsImlzSW5jcmVtZW50YWxJbnN0YWxsU3VwcG9ydGVkIiwiaW5zdGFsbE9wdHMiLCJpbnN0YWxsQ21kIiwicGVyZm9ybUFwcEluc3RhbGwiLCJzaG91bGRDYWNoZUFwcCIsImlzU3RyZWFtZWRJbnN0YWxsU3VwcG9ydGVkIiwiY2xlYXJDYWNoZSIsImNhY2hlQXBwIiwiY2FjaGVkQXBwUGF0aCIsInBtSW5zdGFsbENtZEJ5UmVtb3RlUGF0aCIsIm91dHB1dCIsIm5ld0NhY2hlZEFwcFBhdGgiLCJ0cnVuY2F0ZWRPdXRwdXQiLCJzdWJzdHIiLCJpc1Rlc3RQYWNrYWdlT25seUVycm9yIiwibXNnIiwiZXJyIiwiZ2V0QXBwbGljYXRpb25JbnN0YWxsU3RhdGUiLCJhcGtJbmZvIiwiZ2V0QXBrSW5mbyIsInZlcnNpb25Db2RlIiwicGtnVmVyc2lvbkNvZGUiLCJ2ZXJzaW9uTmFtZSIsInBrZ1ZlcnNpb25OYW1lU3RyIiwiZ2V0UGFja2FnZUluZm8iLCJwa2dWZXJzaW9uTmFtZSIsInNlbXZlciIsInZhbGlkIiwiY29lcmNlIiwiYXBrVmVyc2lvbkNvZGUiLCJhcGtWZXJzaW9uTmFtZVN0ciIsImFwa1ZlcnNpb25OYW1lIiwic2F0aXNmaWVzIiwiaW5zdGFsbE9yVXBncmFkZSIsImVuZm9yY2VDdXJyZW50QnVpbGQiLCJhcHBTdGF0ZSIsIndhc1VuaW5zdGFsbGVkIiwidW5pbnN0YWxsUGFja2FnZSIsIk9iamVjdCIsImFzc2lnbiIsImV4dHJhY3RTdHJpbmdzRnJvbUFwayIsImxhbmd1YWdlIiwib3V0Iiwib3JpZ2luYWxBcHBQYXRoIiwiZXh0cmFjdExhbmd1YWdlQXBrIiwiYXBrU3RyaW5ncyIsImNvbmZpZ01hcmtlciIsImluaXRBYXB0IiwiZm9ybWF0Q29uZmlnTWFya2VyIiwiYmluYXJpZXMiLCJhYXB0IiwidW5pcSIsIm9zIiwiRU9MIiwicGFyc2VBYXB0U3RyaW5ncyIsInN0ZGVyciIsImluaXRBYXB0MiIsImFhcHQyIiwicGFyc2VBYXB0MlN0cmluZ3MiLCJsb2NhbFBhdGgiLCJyZXNvbHZlIiwibWtkaXJwIiwid3JpdGVGaWxlIiwiSlNPTiIsInN0cmluZ2lmeSIsImdldERldmljZUxhbmd1YWdlIiwiZ2V0RGV2aWNlU3lzTGFuZ3VhZ2UiLCJnZXREZXZpY2VQcm9kdWN0TGFuZ3VhZ2UiLCJnZXREZXZpY2VMb2NhbGUiLCJnZXREZXZpY2VDb3VudHJ5IiwiY291bnRyeSIsImdldERldmljZVN5c0NvdW50cnkiLCJnZXREZXZpY2VQcm9kdWN0Q291bnRyeSIsImxvY2FsZSIsImdldERldmljZVN5c0xvY2FsZSIsImdldERldmljZVByb2R1Y3RMb2NhbGUiLCJzZXREZXZpY2VMb2NhbGUiLCJ2YWxpZGF0ZUxvY2FsZSIsInNwbGl0X2xvY2FsZSIsInNldERldmljZUxhbmd1YWdlQ291bnRyeSIsImVuc3VyZUN1cnJlbnRMb2NhbGUiLCJzY3JpcHQiLCJoYXNMYW5ndWFnZSIsImhhc0NvdW50cnkiLCJyZXRyeUludGVydmFsIiwiY3VyTGFuZ3VhZ2UiLCJjdXJDb3VudHJ5IiwiY3VyTG9jYWxlIiwibG9jYWxlQ29kZSIsImVycm9yIiwicmVjb25uZWN0IiwiaWduIiwicmVzdGFydEFkYiIsInRvVXBwZXJDYXNlIiwic2V0RGV2aWNlU3lzTG9jYWxlVmlhU2V0dGluZ0FwcCIsImV4aXN0cyIsImV4dHJhY3RCYXNlQXBrIiwiYXBrUmVhZGVyIiwiQXBrUmVhZGVyIiwib3BlbiIsIm1hbmlmZXN0IiwicmVhZE1hbmlmZXN0IiwicGFyc2VNYW5pZmVzdCIsInJlc3VsdCIsInZlcnNpb25OYW1lTWF0Y2giLCJ2ZXJzaW9uQ29kZU1hdGNoIiwicHVsbEFwayIsInRtcERpciIsInBhY2thZ2VNYXJrZXIiLCJ0bXBBcHAiLCJwdWxsIl0sInNvdXJjZXMiOlsiLi4vLi4vLi4vbGliL3Rvb2xzL2Fway11dGlscy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBidWlsZFN0YXJ0Q21kLCBBUEtTX0VYVEVOU0lPTiwgYnVpbGRJbnN0YWxsQXJncyxcbiAgQVBLX0lOU1RBTExfVElNRU9VVCwgREVGQVVMVF9BREJfRVhFQ19USU1FT1VULFxuICBwYXJzZU1hbmlmZXN0LCBwYXJzZUFhcHRTdHJpbmdzLCBwYXJzZUFhcHQyU3RyaW5ncywgZm9ybWF0Q29uZmlnTWFya2VyLFxuICBlc2NhcGVTaGVsbEFyZyxcbn0gZnJvbSAnLi4vaGVscGVycy5qcyc7XG5pbXBvcnQgeyBleGVjIH0gZnJvbSAndGVlbl9wcm9jZXNzJztcbmltcG9ydCBsb2cgZnJvbSAnLi4vbG9nZ2VyLmpzJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcbmltcG9ydCB7IHJldHJ5SW50ZXJ2YWwsIHdhaXRGb3JDb25kaXRpb24gfSBmcm9tICdhc3luY2JveCc7XG5pbXBvcnQgeyBmcywgdXRpbCwgbWtkaXJwLCB0aW1pbmcgfSBmcm9tICdAYXBwaXVtL3N1cHBvcnQnO1xuaW1wb3J0IHNlbXZlciBmcm9tICdzZW12ZXInO1xuaW1wb3J0IG9zIGZyb20gJ29zJztcbmltcG9ydCBMUlUgZnJvbSAnbHJ1LWNhY2hlJztcbmltcG9ydCBBcGtSZWFkZXIgZnJvbSAnYWRia2l0LWFwa3JlYWRlcic7XG5cbmNvbnN0IGFwa1V0aWxzTWV0aG9kcyA9IHt9O1xuXG5hcGtVdGlsc01ldGhvZHMuQVBQX0lOU1RBTExfU1RBVEUgPSB7XG4gIFVOS05PV046ICd1bmtub3duJyxcbiAgTk9UX0lOU1RBTExFRDogJ25vdEluc3RhbGxlZCcsXG4gIE5FV0VSX1ZFUlNJT05fSU5TVEFMTEVEOiAnbmV3ZXJWZXJzaW9uSW5zdGFsbGVkJyxcbiAgU0FNRV9WRVJTSU9OX0lOU1RBTExFRDogJ3NhbWVWZXJzaW9uSW5zdGFsbGVkJyxcbiAgT0xERVJfVkVSU0lPTl9JTlNUQUxMRUQ6ICdvbGRlclZlcnNpb25JbnN0YWxsZWQnLFxufTtcbmNvbnN0IFJFTU9URV9DQUNIRV9ST09UID0gJy9kYXRhL2xvY2FsL3RtcC9hcHBpdW1fY2FjaGUnO1xuXG5cbi8qKlxuICogQ2hlY2sgd2hldGhlciB0aGUgcGFydGljdWxhciBwYWNrYWdlIGlzIHByZXNlbnQgb24gdGhlIGRldmljZSB1bmRlciB0ZXN0LlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwa2cgLSBUaGUgbmFtZSBvZiB0aGUgcGFja2FnZSB0byBjaGVjay5cbiAqIEByZXR1cm4ge2Jvb2xlYW59IFRydWUgaWYgdGhlIHBhY2thZ2UgaXMgaW5zdGFsbGVkLlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZXJlIHdhcyBhbiBlcnJvciB3aGlsZSBkZXRlY3RpbmcgYXBwbGljYXRpb24gc3RhdGVcbiAqL1xuYXBrVXRpbHNNZXRob2RzLmlzQXBwSW5zdGFsbGVkID0gYXN5bmMgZnVuY3Rpb24gaXNBcHBJbnN0YWxsZWQgKHBrZykge1xuICBsb2cuZGVidWcoYEdldHRpbmcgaW5zdGFsbCBzdGF0dXMgZm9yICR7cGtnfWApO1xuICBjb25zdCBpbnN0YWxsZWRQYXR0ZXJuID0gbmV3IFJlZ0V4cChgXlxcXFxzKlBhY2thZ2VcXFxccytcXFxcWyR7Xy5lc2NhcGVSZWdFeHAocGtnKX1cXFxcXVteOl0rOiRgLCAnbScpO1xuICB0cnkge1xuICAgIGNvbnN0IHN0ZG91dCA9IGF3YWl0IHRoaXMuc2hlbGwoWydkdW1wc3lzJywgJ3BhY2thZ2UnLCBwa2ddKTtcbiAgICBjb25zdCBpc0luc3RhbGxlZCA9IGluc3RhbGxlZFBhdHRlcm4udGVzdChzdGRvdXQpO1xuICAgIGxvZy5kZWJ1ZyhgJyR7cGtnfScgaXMkeyFpc0luc3RhbGxlZCA/ICcgbm90JyA6ICcnfSBpbnN0YWxsZWRgKTtcbiAgICByZXR1cm4gaXNJbnN0YWxsZWQ7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIGZpbmRpbmcgaWYgJyR7cGtnfScgaXMgaW5zdGFsbGVkLiBPcmlnaW5hbCBlcnJvcjogJHtlLm1lc3NhZ2V9YCk7XG4gIH1cbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gU3RhcnRVcmlPcHRpb25zXG4gKiBAcHJvcGVydHkgez9ib29sZWFufSB3YWl0Rm9yTGF1bmNoIFt0cnVlXSAtIGlmIGBmYWxzZWAgdGhlbiBhZGIgd29uJ3Qgd2FpdFxuICogZm9yIHRoZSBzdGFydGVkIGFjdGl2aXR5IHRvIHJldHVybiB0aGUgY29udHJvbFxuICovXG5cbi8qKlxuICogU3RhcnQgdGhlIHBhcnRpY3VsYXIgVVJJIG9uIHRoZSBkZXZpY2UgdW5kZXIgdGVzdC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJpIC0gVGhlIG5hbWUgb2YgVVJJIHRvIHN0YXJ0LlxuICogQHBhcmFtIHtzdHJpbmd9IHBrZyAtIFRoZSBuYW1lIG9mIHRoZSBwYWNrYWdlIHRvIHN0YXJ0IHRoZSBVUkkgd2l0aC5cbiAqIEBwYXJhbSB7U3RhcnRVcmlPcHRpb25zfSBvcHRzXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5zdGFydFVyaSA9IGFzeW5jIGZ1bmN0aW9uIHN0YXJ0VXJpICh1cmksIHBrZywgb3B0cyA9IHt9KSB7XG4gIGNvbnN0IHtcbiAgICB3YWl0Rm9yTGF1bmNoID0gdHJ1ZSxcbiAgfSA9IG9wdHM7XG5cbiAgaWYgKCF1cmkgfHwgIXBrZykge1xuICAgIHRocm93IG5ldyBFcnJvcignVVJJIGFuZCBwYWNrYWdlIGFyZ3VtZW50cyBhcmUgcmVxdWlyZWQnKTtcbiAgfVxuXG4gIGNvbnN0IGFyZ3MgPSBbJ2FtJywgJ3N0YXJ0J107XG4gIGlmICh3YWl0Rm9yTGF1bmNoKSB7XG4gICAgYXJncy5wdXNoKCctVycpO1xuICB9XG4gIGFyZ3MucHVzaCgnLWEnLCAnYW5kcm9pZC5pbnRlbnQuYWN0aW9uLlZJRVcnLFxuICAgICctZCcsIGVzY2FwZVNoZWxsQXJnKHVyaSksXG4gICAgcGtnKTtcblxuICB0cnkge1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuc2hlbGwoYXJncyk7XG4gICAgaWYgKHJlcy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCd1bmFibGUgdG8gcmVzb2x2ZSBpbnRlbnQnKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKHJlcyk7XG4gICAgfVxuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciBhdHRlbXB0aW5nIHRvIHN0YXJ0IFVSSS4gT3JpZ2luYWwgZXJyb3I6ICR7ZX1gKTtcbiAgfVxufTtcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBTdGFydEFwcE9wdGlvbnNcbiAqIEBwcm9wZXJ0eSB7IXN0cmluZ30gcGtnIC0gVGhlIG5hbWUgb2YgdGhlIGFwcGxpY2F0aW9uIHBhY2thZ2VcbiAqIEBwcm9wZXJ0eSB7P3N0cmluZ30gYWN0aXZpdHkgLSBUaGUgbmFtZSBvZiB0aGUgbWFpbiBhcHBsaWNhdGlvbiBhY3Rpdml0eS5cbiAqIFRoaXMgb3IgYWN0aW9uIGlzIHJlcXVpcmVkIGluIG9yZGVyIHRvIGJlIGFibGUgdG8gbGF1bmNoIGFuIGFwcC5cbiAqIEBwcm9wZXJ0eSB7P3N0cmluZ30gYWN0aW9uIC0gVGhlIG5hbWUgb2YgdGhlIGludGVudCBhY3Rpb24gdGhhdCB3aWxsIGxhdW5jaCB0aGUgcmVxdWlyZWQgYXBwLlxuICogVGhpcyBvciBhY3Rpdml0eSBpcyByZXF1aXJlZCBpbiBvcmRlciB0byBiZSBhYmxlIHRvIGxhdW5jaCBhbiBhcHAuXG4gKiBAcHJvcGVydHkgez9ib29sZWFufSByZXRyeSBbdHJ1ZV0gLSBJZiB0aGlzIHByb3BlcnR5IGlzIHNldCB0byBgdHJ1ZWBcbiAqIGFuZCB0aGUgYWN0aXZpdHkgbmFtZSBkb2VzIG5vdCBzdGFydCB3aXRoICcuJyB0aGVuIHRoZSBtZXRob2RcbiAqIHdpbGwgdHJ5IHRvIGFkZCB0aGUgbWlzc2luZyBkb3QgYW5kIHN0YXJ0IHRoZSBhY3Rpdml0eSBvbmNlIG1vcmVcbiAqIGlmIHRoZSBmaXJzdCBzdGFydHVwIHRyeSBmYWlscy5cbiAqIEBwcm9wZXJ0eSB7P2Jvb2xlYW59IHN0b3BBcHAgW3RydWVdIC0gU2V0IGl0IHRvIGB0cnVlYCBpbiBvcmRlciB0byBmb3JjZWZ1bGx5XG4gKiBzdG9wIHRoZSBhY3Rpdml0eSBpZiBpdCBpcyBhbHJlYWR5IHJ1bm5pbmcuXG4gKiBAcHJvcGVydHkgez9zdHJpbmd9IHdhaXRQa2cgLSBUaGUgbmFtZSBvZiB0aGUgcGFja2FnZSB0byB3YWl0IHRvIG9uXG4gKiBzdGFydHVwICh0aGlzIG9ubHkgbWFrZXMgc2Vuc2UgaWYgdGhpcyBuYW1lIGlzIGRpZmZlcmVudCBmcm9tIHRoZSBvbmUsIHdoaWNoIGlzIHNldCBhcyBgcGtnYClcbiAqIEBwcm9wZXJ0eSB7P3N0cmluZ30gd2FpdEFjdGl2aXR5IC0gVGhlIG5hbWUgb2YgdGhlIGFjdGl2aXR5IHRvIHdhaXQgdG8gb25cbiAqIHN0YXJ0dXAgKHRoaXMgb25seSBtYWtlcyBzZW5zZSBpZiB0aGlzIG5hbWUgaXMgZGlmZmVyZW50IGZyb20gdGhlIG9uZSwgd2hpY2ggaXMgc2V0IGFzIGBhY3Rpdml0eWApXG4gKiBAcHJvcGVydHkgez9udW1iZXJ9IHdhaXREdXJhdGlvbiAtIFRoZSBudW1iZXIgb2YgbWlsbGlzZWNvbmRzIHRvIHdhaXQgdW50aWwgdGhlXG4gKiBgd2FpdEFjdGl2aXR5YCBpcyBmb2N1c2VkXG4gKiBAcHJvcGVydHkgez9zdHJpbmd8bnVtYmVyfSB1c2VyIC0gVGhlIG51bWJlciBvZiB0aGUgdXNlciBwcm9maWxlIHRvIHN0YXJ0XG4gKiB0aGUgZ2l2ZW4gYWN0aXZpdHkgd2l0aC4gVGhlIGRlZmF1bHQgT1MgdXNlciBwcm9maWxlICh1c3VhbGx5IHplcm8pIGlzIHVzZWRcbiAqIHdoZW4gdGhpcyBwcm9wZXJ0eSBpcyB1bnNldFxuICogQHByb3BlcnR5IHs/Ym9vbGVhbn0gd2FpdEZvckxhdW5jaCBbdHJ1ZV0gLSBpZiBgZmFsc2VgIHRoZW4gYWRiIHdvbid0IHdhaXRcbiAqIGZvciB0aGUgc3RhcnRlZCBhY3Rpdml0eSB0byByZXR1cm4gdGhlIGNvbnRyb2xcbiAqL1xuXG4vKipcbiAqIFN0YXJ0IHRoZSBwYXJ0aWN1bGFyIHBhY2thZ2UvYWN0aXZpdHkgb24gdGhlIGRldmljZSB1bmRlciB0ZXN0LlxuICpcbiAqIEBwYXJhbSB7U3RhcnRBcHBPcHRpb25zfSBzdGFydEFwcE9wdGlvbnMgW3t9XSAtIFN0YXJ0dXAgb3B0aW9ucyBtYXBwaW5nLlxuICogQHJldHVybiB7c3RyaW5nfSBUaGUgb3V0cHV0IG9mIHRoZSBjb3JyZXNwb25kaW5nIGFkYiBjb21tYW5kLlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZXJlIGlzIGFuIGVycm9yIHdoaWxlIGV4ZWN1dGluZyB0aGUgYWN0aXZpdHlcbiAqL1xuYXBrVXRpbHNNZXRob2RzLnN0YXJ0QXBwID0gYXN5bmMgZnVuY3Rpb24gc3RhcnRBcHAgKHN0YXJ0QXBwT3B0aW9ucyA9IHt9KSB7XG4gIGlmICghc3RhcnRBcHBPcHRpb25zLnBrZyB8fCAhKHN0YXJ0QXBwT3B0aW9ucy5hY3Rpdml0eSB8fCBzdGFydEFwcE9wdGlvbnMuYWN0aW9uKSkge1xuICAgIHRocm93IG5ldyBFcnJvcigncGtnLCBhbmQgYWN0aXZpdHkgb3IgaW50ZW50IGFjdGlvbiwgYXJlIHJlcXVpcmVkIHRvIHN0YXJ0IGFuIGFwcGxpY2F0aW9uJyk7XG4gIH1cblxuICBzdGFydEFwcE9wdGlvbnMgPSBfLmNsb25lKHN0YXJ0QXBwT3B0aW9ucyk7XG4gIGlmIChzdGFydEFwcE9wdGlvbnMuYWN0aXZpdHkpIHtcbiAgICBzdGFydEFwcE9wdGlvbnMuYWN0aXZpdHkgPSBzdGFydEFwcE9wdGlvbnMuYWN0aXZpdHkucmVwbGFjZSgnJCcsICdcXFxcJCcpO1xuICB9XG4gIC8vIGluaXRpYWxpemluZyBkZWZhdWx0c1xuICBfLmRlZmF1bHRzKHN0YXJ0QXBwT3B0aW9ucywge1xuICAgIHdhaXRQa2c6IHN0YXJ0QXBwT3B0aW9ucy5wa2csXG4gICAgd2FpdEZvckxhdW5jaDogdHJ1ZSxcbiAgICB3YWl0QWN0aXZpdHk6IGZhbHNlLFxuICAgIHJldHJ5OiB0cnVlLFxuICAgIHN0b3BBcHA6IHRydWVcbiAgfSk7XG4gIC8vIHByZXZlbnRpbmcgbnVsbCB3YWl0cGtnXG4gIHN0YXJ0QXBwT3B0aW9ucy53YWl0UGtnID0gc3RhcnRBcHBPcHRpb25zLndhaXRQa2cgfHwgc3RhcnRBcHBPcHRpb25zLnBrZztcblxuICBjb25zdCBhcGlMZXZlbCA9IGF3YWl0IHRoaXMuZ2V0QXBpTGV2ZWwoKTtcbiAgY29uc3QgY21kID0gYnVpbGRTdGFydENtZChzdGFydEFwcE9wdGlvbnMsIGFwaUxldmVsKTtcbiAgY29uc3QgaW50ZW50TmFtZSA9IGAke3N0YXJ0QXBwT3B0aW9ucy5hY3Rpb259JHtzdGFydEFwcE9wdGlvbnMub3B0aW9uYWxJbnRlbnRBcmd1bWVudHMgPyAnICcgKyBzdGFydEFwcE9wdGlvbnMub3B0aW9uYWxJbnRlbnRBcmd1bWVudHMgOiAnJ31gO1xuICB0cnkge1xuICAgIGNvbnN0IHNoZWxsT3B0cyA9IHt9O1xuICAgIGlmIChfLmlzSW50ZWdlcihzdGFydEFwcE9wdGlvbnMud2FpdER1cmF0aW9uKSAmJiBzdGFydEFwcE9wdGlvbnMud2FpdER1cmF0aW9uID49IDApIHtcbiAgICAgIHNoZWxsT3B0cy50aW1lb3V0ID0gc3RhcnRBcHBPcHRpb25zLndhaXREdXJhdGlvbjtcbiAgICB9XG4gICAgY29uc3Qgc3Rkb3V0ID0gYXdhaXQgdGhpcy5zaGVsbChjbWQsIHNoZWxsT3B0cyk7XG4gICAgaWYgKHN0ZG91dC5pbmNsdWRlcygnRXJyb3I6IEFjdGl2aXR5IGNsYXNzJykgJiYgc3Rkb3V0LmluY2x1ZGVzKCdkb2VzIG5vdCBleGlzdCcpKSB7XG4gICAgICBpZiAoc3RhcnRBcHBPcHRpb25zLnJldHJ5ICYmICFzdGFydEFwcE9wdGlvbnMuYWN0aXZpdHkuc3RhcnRzV2l0aCgnLicpKSB7XG4gICAgICAgIGxvZy5kZWJ1ZyhgV2UgdHJpZWQgdG8gc3RhcnQgYW4gYWN0aXZpdHkgdGhhdCBkb2Vzbid0IGV4aXN0LCBgICtcbiAgICAgICAgICAgICAgICAgIGByZXRyeWluZyB3aXRoICcuJHtzdGFydEFwcE9wdGlvbnMuYWN0aXZpdHl9JyBhY3Rpdml0eSBuYW1lYCk7XG4gICAgICAgIHN0YXJ0QXBwT3B0aW9ucy5hY3Rpdml0eSA9IGAuJHtzdGFydEFwcE9wdGlvbnMuYWN0aXZpdHl9YDtcbiAgICAgICAgc3RhcnRBcHBPcHRpb25zLnJldHJ5ID0gZmFsc2U7XG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLnN0YXJ0QXBwKHN0YXJ0QXBwT3B0aW9ucyk7XG4gICAgICB9XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEFjdGl2aXR5IG5hbWUgJyR7c3RhcnRBcHBPcHRpb25zLmFjdGl2aXR5fScgdXNlZCB0byBzdGFydCB0aGUgYXBwIGRvZXNuJ3QgYCArXG4gICAgICAgICAgICAgICAgICAgICAgYGV4aXN0IG9yIGNhbm5vdCBiZSBsYXVuY2hlZCEgTWFrZSBzdXJlIGl0IGV4aXN0cyBhbmQgaXMgYSBsYXVuY2hhYmxlIGFjdGl2aXR5YCk7XG4gICAgfSBlbHNlIGlmIChzdGRvdXQuaW5jbHVkZXMoJ0Vycm9yOiBJbnRlbnQgZG9lcyBub3QgbWF0Y2ggYW55IGFjdGl2aXRpZXMnKSB8fCBzdGRvdXQuaW5jbHVkZXMoJ0Vycm9yOiBBY3Rpdml0eSBub3Qgc3RhcnRlZCwgdW5hYmxlIHRvIHJlc29sdmUgSW50ZW50JykpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQWN0aXZpdHkgZm9yIGludGVudCAnJHtpbnRlbnROYW1lfScgdXNlZCB0byBzdGFydCB0aGUgYXBwIGRvZXNuJ3QgYCArXG4gICAgICAgICAgICAgICAgICAgICAgYGV4aXN0IG9yIGNhbm5vdCBiZSBsYXVuY2hlZCEgTWFrZSBzdXJlIGl0IGV4aXN0cyBhbmQgaXMgYSBsYXVuY2hhYmxlIGFjdGl2aXR5YCk7XG4gICAgfSBlbHNlIGlmIChzdGRvdXQuaW5jbHVkZXMoJ2phdmEubGFuZy5TZWN1cml0eUV4Y2VwdGlvbicpKSB7XG4gICAgICAvLyBpZiB0aGUgYXBwIGlzIGRpc2FibGVkIG9uIGEgcmVhbCBkZXZpY2UgaXQgd2lsbCB0aHJvdyBhIHNlY3VyaXR5IGV4Y2VwdGlvblxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgcGVybWlzc2lvbiB0byBzdGFydCAnJHtzdGFydEFwcE9wdGlvbnMuYWN0aXZpdHl9JyBhY3Rpdml0eSBoYXMgYmVlbiBkZW5pZWQuYCArXG4gICAgICAgICAgICAgICAgICAgICAgYE1ha2Ugc3VyZSB0aGUgYWN0aXZpdHkvcGFja2FnZSBuYW1lcyBhcmUgY29ycmVjdC5gKTtcbiAgICB9XG4gICAgaWYgKHN0YXJ0QXBwT3B0aW9ucy53YWl0QWN0aXZpdHkpIHtcbiAgICAgIGF3YWl0IHRoaXMud2FpdEZvckFjdGl2aXR5KHN0YXJ0QXBwT3B0aW9ucy53YWl0UGtnLCBzdGFydEFwcE9wdGlvbnMud2FpdEFjdGl2aXR5LCBzdGFydEFwcE9wdGlvbnMud2FpdER1cmF0aW9uKTtcbiAgICB9XG4gICAgcmV0dXJuIHN0ZG91dDtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGNvbnN0IGFwcERlc2NyaXB0b3IgPSBzdGFydEFwcE9wdGlvbnMucGtnIHx8IGludGVudE5hbWU7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBDYW5ub3Qgc3RhcnQgdGhlICcke2FwcERlc2NyaXB0b3J9JyBhcHBsaWNhdGlvbi4gYCArXG4gICAgICBgQ29uc2lkZXIgY2hlY2tpbmcgdGhlIGRyaXZlcidzIHRyb3VibGVzaG9vdGluZyBkb2N1bWVudGF0aW9uLiBgICtcbiAgICAgIGBPcmlnaW5hbCBlcnJvcjogJHtlLm1lc3NhZ2V9YCk7XG4gIH1cbn07XG5cbi8qKlxuICogSGVscGVyIG1ldGhvZCB0byBjYWxsIGBhZGIgZHVtcHN5cyB3aW5kb3cgd2luZG93cy9kaXNwbGF5c2BcbiAqL1xuYXBrVXRpbHNNZXRob2RzLmR1bXBXaW5kb3dzID0gYXN5bmMgZnVuY3Rpb24gZHVtcFdpbmRvd3MgKCkge1xuICBjb25zdCBhcGlMZXZlbCA9IGF3YWl0IHRoaXMuZ2V0QXBpTGV2ZWwoKTtcblxuICAvLyBXaXRoIHZlcnNpb24gMjksIEFuZHJvaWQgY2hhbmdlZCB0aGUgZHVtcHN5cyBzeW50YXhcbiAgY29uc3QgZHVtcHN5c0FyZyA9IGFwaUxldmVsID49IDI5ID8gJ2Rpc3BsYXlzJyA6ICd3aW5kb3dzJztcbiAgY29uc3QgY21kID0gWydkdW1wc3lzJywgJ3dpbmRvdycsIGR1bXBzeXNBcmddO1xuXG4gIHJldHVybiBhd2FpdCB0aGlzLnNoZWxsKGNtZCk7XG59O1xuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IFBhY2thZ2VBY3Rpdml0eUluZm9cbiAqIEBwcm9wZXJ0eSB7P3N0cmluZ30gYXBwUGFja2FnZSAtIFRoZSBuYW1lIG9mIGFwcGxpY2F0aW9uIHBhY2thZ2UsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgZXhhbXBsZSAnY29tLmFjbWUuYXBwJy5cbiAqIEBwcm9wZXJ0eSB7P3N0cmluZ30gYXBwQWN0aXZpdHkgLSBUaGUgbmFtZSBvZiBtYWluIGFwcGxpY2F0aW9uIGFjdGl2aXR5LlxuICovXG5cbi8qKlxuICogR2V0IHRoZSBuYW1lIG9mIGN1cnJlbnRseSBmb2N1c2VkIHBhY2thZ2UgYW5kIGFjdGl2aXR5LlxuICpcbiAqIEByZXR1cm4ge1BhY2thZ2VBY3Rpdml0eUluZm99IFRoZSBtYXBwaW5nLCB3aGVyZSBwcm9wZXJ0eSBuYW1lcyBhcmUgJ2FwcFBhY2thZ2UnIGFuZCAnYXBwQWN0aXZpdHknLlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZXJlIGlzIGFuIGVycm9yIHdoaWxlIHBhcnNpbmcgdGhlIGRhdGEuXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5nZXRGb2N1c2VkUGFja2FnZUFuZEFjdGl2aXR5ID0gYXN5bmMgZnVuY3Rpb24gZ2V0Rm9jdXNlZFBhY2thZ2VBbmRBY3Rpdml0eSAoKSB7XG4gIGxvZy5kZWJ1ZygnR2V0dGluZyBmb2N1c2VkIHBhY2thZ2UgYW5kIGFjdGl2aXR5Jyk7XG4gIGxldCBzdGRvdXQ7XG4gIHRyeSB7XG4gICAgc3Rkb3V0ID0gYXdhaXQgdGhpcy5kdW1wV2luZG93cygpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgYENvdWxkIG5vdCByZXRyaWV2ZSB0aGUgY3VycmVudGx5IGZvY3VzZWQgcGFja2FnZSBhbmQgYWN0aXZpdHkuIE9yaWdpbmFsIGVycm9yOiAke2UubWVzc2FnZX1gXG4gICAgKTtcbiAgfVxuXG4gIGNvbnN0IG51bGxGb2N1c2VkQXBwUmUgPSAvXlxccyptRm9jdXNlZEFwcD1udWxsL207XG4gIC8vIGh0dHBzOi8vcmVnZXgxMDEuY29tL3IveFo4dkY3LzFcbiAgY29uc3QgZm9jdXNlZEFwcFJlID0gbmV3IFJlZ0V4cChcbiAgICAnXlxcXFxzKm1Gb2N1c2VkQXBwLitSZWNvcmRcXFxcey4qXFxcXHMoW15cXFxcc1xcXFwvXFxcXH1dKylcXFxcLyhbXlxcXFxzXFxcXC9cXFxcfVxcXFwsXSspXFxcXCw/KFxcXFxzW15cXFxcc1xcXFwvXFxcXH1dKykqXFxcXH0nLFxuICAgICdtZydcbiAgKTtcbiAgY29uc3QgbnVsbEN1cnJlbnRGb2N1c1JlID0gL15cXHMqbUN1cnJlbnRGb2N1cz1udWxsL207XG4gIGNvbnN0IGN1cnJlbnRGb2N1c0FwcFJlID0gbmV3IFJlZ0V4cCgnXlxcXFxzKm1DdXJyZW50Rm9jdXMuK1xcXFx7LitcXFxccyhbXlxcXFxzXFxcXC9dKylcXFxcLyhbXlxcXFxzXSspXFxcXGInLCAnbWcnKTtcblxuICBjb25zdCBmb2N1c2VkQXBwQ2FuZGlkYXRlcyA9IFtdO1xuICBjb25zdCBjdXJyZW50Rm9jdXNBcHBDYW5kaWRhdGVzID0gW107XG4gIGZvciAoY29uc3QgW2NhbmRpZGF0ZXMsIHBhdHRlcm5dIG9mIFtcbiAgICBbZm9jdXNlZEFwcENhbmRpZGF0ZXMsIGZvY3VzZWRBcHBSZV0sXG4gICAgW2N1cnJlbnRGb2N1c0FwcENhbmRpZGF0ZXMsIGN1cnJlbnRGb2N1c0FwcFJlXVxuICBdKSB7XG4gICAgbGV0IG1hdGNoO1xuICAgIHdoaWxlICgobWF0Y2ggPSBwYXR0ZXJuLmV4ZWMoc3Rkb3V0KSkpIHtcbiAgICAgIGNhbmRpZGF0ZXMucHVzaCh7XG4gICAgICAgIGFwcFBhY2thZ2U6IG1hdGNoWzFdLnRyaW0oKSxcbiAgICAgICAgYXBwQWN0aXZpdHk6IG1hdGNoWzJdLnRyaW0oKVxuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIGlmIChmb2N1c2VkQXBwQ2FuZGlkYXRlcy5sZW5ndGggPiAxICYmIGN1cnJlbnRGb2N1c0FwcENhbmRpZGF0ZXMubGVuZ3RoID4gMCkge1xuICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9hcHBpdW0vYXBwaXVtL2lzc3Vlcy8xNzEwNlxuICAgIHJldHVybiBfLmludGVyc2VjdGlvbldpdGgoZm9jdXNlZEFwcENhbmRpZGF0ZXMsIGN1cnJlbnRGb2N1c0FwcENhbmRpZGF0ZXMsIF8uaXNFcXVhbClbMF1cbiAgICAgID8/IGZvY3VzZWRBcHBDYW5kaWRhdGVzWzBdO1xuICB9XG4gIGlmIChmb2N1c2VkQXBwQ2FuZGlkYXRlcy5sZW5ndGggPiAwIHx8IGN1cnJlbnRGb2N1c0FwcENhbmRpZGF0ZXMubGVuZ3RoID4gMCkge1xuICAgIHJldHVybiBmb2N1c2VkQXBwQ2FuZGlkYXRlc1swXSA/PyBjdXJyZW50Rm9jdXNBcHBDYW5kaWRhdGVzWzBdO1xuICB9XG5cbiAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIFtudWxsRm9jdXNlZEFwcFJlLCBudWxsQ3VycmVudEZvY3VzUmVdKSB7XG4gICAgaWYgKHBhdHRlcm4uZXhlYyhzdGRvdXQpKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBhcHBQYWNrYWdlOiBudWxsLFxuICAgICAgICBhcHBBY3Rpdml0eTogbnVsbFxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICBsb2cuZGVidWcoc3Rkb3V0KTtcbiAgdGhyb3cgbmV3IEVycm9yKCdDb3VsZCBub3QgcmV0cmlldmUgdGhlIGN1cnJlbnRseSBmb2N1c2VkIHBhY2thZ2UgYW5kIGFjdGl2aXR5Jyk7XG59O1xuXG4vKipcbiAqIFdhaXQgZm9yIHRoZSBnaXZlbiBhY3Rpdml0eSB0byBiZSBmb2N1c2VkL25vbi1mb2N1c2VkLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwa2cgLSBUaGUgbmFtZSBvZiB0aGUgcGFja2FnZSB0byB3YWl0IGZvci5cbiAqIEBwYXJhbSB7c3RyaW5nfSBhY3Rpdml0eSAtIFRoZSBuYW1lIG9mIHRoZSBhY3Rpdml0eSwgYmVsb25naW5nIHRvIHRoYXQgcGFja2FnZSxcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIHdhaXQgZm9yLlxuICogQHBhcmFtIHtib29sZWFufSB3YWl0Rm9yU3RvcCAtIFdoZXRoZXIgdG8gd2FpdCB1bnRpbCB0aGUgYWN0aXZpdHkgaXMgZm9jdXNlZCAodHJ1ZSlcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvciBpcyBub3QgZm9jdXNlZCAoZmFsc2UpLlxuICogQHBhcmFtIHtudW1iZXJ9IHdhaXRNcyBbMjAwMDBdIC0gTnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byB3YWl0IGJlZm9yZSB0aW1lb3V0IG9jY3Vycy5cbiAqIEB0aHJvd3Mge2Vycm9yfSBJZiB0aW1lb3V0IGhhcHBlbnMuXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy53YWl0Rm9yQWN0aXZpdHlPck5vdCA9IGFzeW5jIGZ1bmN0aW9uIHdhaXRGb3JBY3Rpdml0eU9yTm90IChwa2csIGFjdGl2aXR5LCB3YWl0Rm9yU3RvcCwgd2FpdE1zID0gMjAwMDApIHtcbiAgaWYgKCFwa2cgfHwgIWFjdGl2aXR5KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdQYWNrYWdlIGFuZCBhY3Rpdml0eSByZXF1aXJlZC4nKTtcbiAgfVxuICBsb2cuZGVidWcoYFdhaXRpbmcgdXAgdG8gJHt3YWl0TXN9bXMgZm9yIGFjdGl2aXR5IG1hdGNoaW5nIHBrZzogJyR7cGtnfScgYW5kIGAgK1xuICAgICAgICAgICAgYGFjdGl2aXR5OiAnJHthY3Rpdml0eX0nIHRvJHt3YWl0Rm9yU3RvcCA/ICcgbm90JyA6ICcnfSBiZSBmb2N1c2VkYCk7XG5cbiAgY29uc3Qgc3BsaXROYW1lcyA9IChuYW1lcykgPT4gbmFtZXMuc3BsaXQoJywnKS5tYXAoKG5hbWUpID0+IG5hbWUudHJpbSgpKTtcbiAgY29uc3QgYWxsUGFja2FnZXMgPSBzcGxpdE5hbWVzKHBrZyk7XG4gIGNvbnN0IGFsbEFjdGl2aXRpZXMgPSBzcGxpdE5hbWVzKGFjdGl2aXR5KTtcblxuICBjb25zdCBwb3NzaWJsZUFjdGl2aXR5TmFtZXMgPSBbXTtcbiAgZm9yIChjb25zdCBvbmVBY3Rpdml0eSBvZiBhbGxBY3Rpdml0aWVzKSB7XG4gICAgaWYgKG9uZUFjdGl2aXR5LnN0YXJ0c1dpdGgoJy4nKSkge1xuICAgICAgLy8gYWRkIHRoZSBwYWNrYWdlIG5hbWUgaWYgYWN0aXZpdHkgaXMgbm90IGZ1bGwgcXVhbGlmaWVkXG4gICAgICBmb3IgKGNvbnN0IGN1cnJlbnRQa2cgb2YgYWxsUGFja2FnZXMpIHtcbiAgICAgICAgcG9zc2libGVBY3Rpdml0eU5hbWVzLnB1c2goYCR7Y3VycmVudFBrZ30ke29uZUFjdGl2aXR5fWAucmVwbGFjZSgvXFwuKy9nLCAnLicpKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gYWNjZXB0IGZ1bGx5IHF1YWxpZmllZCBhY3Rpdml0eSBuYW1lLlxuICAgICAgcG9zc2libGVBY3Rpdml0eU5hbWVzLnB1c2gob25lQWN0aXZpdHkpO1xuICAgICAgcG9zc2libGVBY3Rpdml0eU5hbWVzLnB1c2goYCR7cGtnfS4ke29uZUFjdGl2aXR5fWApO1xuICAgIH1cbiAgfVxuICBsb2cuZGVidWcoYFBvc3NpYmxlIGFjdGl2aXRpZXMsIHRvIGJlIGNoZWNrZWQ6ICR7cG9zc2libGVBY3Rpdml0eU5hbWVzLm1hcCgobmFtZSkgPT4gYCcke25hbWV9J2ApLmpvaW4oJywgJyl9YCk7XG5cbiAgY29uc3QgcG9zc2libGVBY3Rpdml0eVBhdHRlcm5zID0gcG9zc2libGVBY3Rpdml0eU5hbWVzLm1hcChcbiAgICAoYWN0TmFtZSkgPT4gbmV3IFJlZ0V4cChgXiR7YWN0TmFtZS5yZXBsYWNlKC9cXC4vZywgJ1xcXFwuJykucmVwbGFjZSgvXFwqL2csICcuKj8nKS5yZXBsYWNlKC9cXCQvZywgJ1xcXFwkJyl9JGApXG4gICk7XG5cbiAgY29uc3QgY29uZGl0aW9uRnVuYyA9IGFzeW5jICgpID0+IHtcbiAgICBsZXQgYXBwUGFja2FnZTtcbiAgICBsZXQgYXBwQWN0aXZpdHk7XG4gICAgdHJ5IHtcbiAgICAgICh7YXBwUGFja2FnZSwgYXBwQWN0aXZpdHl9ID0gYXdhaXQgdGhpcy5nZXRGb2N1c2VkUGFja2FnZUFuZEFjdGl2aXR5KCkpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGxvZy5kZWJ1ZyhlLm1lc3NhZ2UpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoYXBwQWN0aXZpdHkgJiYgYXBwUGFja2FnZSkge1xuICAgICAgY29uc3QgZnVsbHlRdWFsaWZpZWRBY3Rpdml0eSA9IGFwcEFjdGl2aXR5LnN0YXJ0c1dpdGgoJy4nKSA/IGAke2FwcFBhY2thZ2V9JHthcHBBY3Rpdml0eX1gIDogYXBwQWN0aXZpdHk7XG4gICAgICBsb2cuZGVidWcoYEZvdW5kIHBhY2thZ2U6ICcke2FwcFBhY2thZ2V9JyBhbmQgZnVsbHkgcXVhbGlmaWVkIGFjdGl2aXR5IG5hbWUgOiAnJHtmdWxseVF1YWxpZmllZEFjdGl2aXR5fSdgKTtcbiAgICAgIGNvbnN0IGlzQWN0aXZpdHlGb3VuZCA9IF8uaW5jbHVkZXMoYWxsUGFja2FnZXMsIGFwcFBhY2thZ2UpXG4gICAgICAgICYmIHBvc3NpYmxlQWN0aXZpdHlQYXR0ZXJucy5zb21lKChwKSA9PiBwLnRlc3QoZnVsbHlRdWFsaWZpZWRBY3Rpdml0eSkpO1xuICAgICAgaWYgKCghd2FpdEZvclN0b3AgJiYgaXNBY3Rpdml0eUZvdW5kKSB8fCAod2FpdEZvclN0b3AgJiYgIWlzQWN0aXZpdHlGb3VuZCkpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgfVxuICAgIGxvZy5kZWJ1ZygnSW5jb3JyZWN0IHBhY2thZ2UgYW5kIGFjdGl2aXR5LiBSZXRyeWluZy4nKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG5cbiAgdHJ5IHtcbiAgICBhd2FpdCB3YWl0Rm9yQ29uZGl0aW9uKGNvbmRpdGlvbkZ1bmMsIHtcbiAgICAgIHdhaXRNczogcGFyc2VJbnQod2FpdE1zLCAxMCksXG4gICAgICBpbnRlcnZhbE1zOiA1MDAsXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYCR7cG9zc2libGVBY3Rpdml0eU5hbWVzLm1hcCgobmFtZSkgPT4gYCcke25hbWV9J2ApLmpvaW4oJyBvciAnKX0gbmV2ZXIgJHt3YWl0Rm9yU3RvcCA/ICdzdG9wcGVkJyA6ICdzdGFydGVkJ30uIGAgK1xuICAgICAgYENvbnNpZGVyIGNoZWNraW5nIHRoZSBkcml2ZXIncyB0cm91Ymxlc2hvb3RpbmcgZG9jdW1lbnRhdGlvbi5gKTtcbiAgfVxufTtcblxuLyoqXG4gKiBXYWl0IGZvciB0aGUgZ2l2ZW4gYWN0aXZpdHkgdG8gYmUgZm9jdXNlZFxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwa2cgLSBUaGUgbmFtZSBvZiB0aGUgcGFja2FnZSB0byB3YWl0IGZvci5cbiAqIEBwYXJhbSB7c3RyaW5nfSBhY3Rpdml0eSAtIFRoZSBuYW1lIG9mIHRoZSBhY3Rpdml0eSwgYmVsb25naW5nIHRvIHRoYXQgcGFja2FnZSxcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIHdhaXQgZm9yLlxuICogQHBhcmFtIHtudW1iZXJ9IHdhaXRNcyBbMjAwMDBdIC0gTnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byB3YWl0IGJlZm9yZSB0aW1lb3V0IG9jY3Vycy5cbiAqIEB0aHJvd3Mge2Vycm9yfSBJZiB0aW1lb3V0IGhhcHBlbnMuXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy53YWl0Rm9yQWN0aXZpdHkgPSBhc3luYyBmdW5jdGlvbiB3YWl0Rm9yQWN0aXZpdHkgKHBrZywgYWN0LCB3YWl0TXMgPSAyMDAwMCkge1xuICBhd2FpdCB0aGlzLndhaXRGb3JBY3Rpdml0eU9yTm90KHBrZywgYWN0LCBmYWxzZSwgd2FpdE1zKTtcbn07XG5cbi8qKlxuICogV2FpdCBmb3IgdGhlIGdpdmVuIGFjdGl2aXR5IHRvIGJlIG5vbi1mb2N1c2VkLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwa2cgLSBUaGUgbmFtZSBvZiB0aGUgcGFja2FnZSB0byB3YWl0IGZvci5cbiAqIEBwYXJhbSB7c3RyaW5nfSBhY3Rpdml0eSAtIFRoZSBuYW1lIG9mIHRoZSBhY3Rpdml0eSwgYmVsb25naW5nIHRvIHRoYXQgcGFja2FnZSxcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvIHdhaXQgZm9yLlxuICogQHBhcmFtIHtudW1iZXJ9IHdhaXRNcyBbMjAwMDBdIC0gTnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byB3YWl0IGJlZm9yZSB0aW1lb3V0IG9jY3Vycy5cbiAqIEB0aHJvd3Mge2Vycm9yfSBJZiB0aW1lb3V0IGhhcHBlbnMuXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy53YWl0Rm9yTm90QWN0aXZpdHkgPSBhc3luYyBmdW5jdGlvbiB3YWl0Rm9yTm90QWN0aXZpdHkgKHBrZywgYWN0LCB3YWl0TXMgPSAyMDAwMCkge1xuICBhd2FpdCB0aGlzLndhaXRGb3JBY3Rpdml0eU9yTm90KHBrZywgYWN0LCB0cnVlLCB3YWl0TXMpO1xufTtcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBVbmluc3RhbGxPcHRpb25zXG4gKiBAcHJvcGVydHkge251bWJlcn0gdGltZW91dCBbYWRiRXhlY1RpbWVvdXRdIC0gVGhlIGNvdW50IG9mIG1pbGxpc2Vjb25kcyB0byB3YWl0IHVudGlsIHRoZVxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcCBpcyB1bmluc3RhbGxlZC5cbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0ga2VlcERhdGEgW2ZhbHNlXSAtIFNldCB0byB0cnVlIGluIG9yZGVyIHRvIGtlZXAgdGhlXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHBsaWNhdGlvbiBkYXRhIGFuZCBjYWNoZSBmb2xkZXJzIGFmdGVyIHVuaW5zdGFsbC5cbiAqL1xuXG4vKipcbiAqIFVuaW5zdGFsbCB0aGUgZ2l2ZW4gcGFja2FnZSBmcm9tIHRoZSBkZXZpY2UgdW5kZXIgdGVzdC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcGtnIC0gVGhlIG5hbWUgb2YgdGhlIHBhY2thZ2UgdG8gYmUgdW5pbnN0YWxsZWQuXG4gKiBAcGFyYW0gez9Vbmluc3RhbGxPcHRpb25zfSBvcHRpb25zIC0gVGhlIHNldCBvZiB1bmluc3RhbGwgb3B0aW9ucy5cbiAqIEByZXR1cm4ge2Jvb2xlYW59IFRydWUgaWYgdGhlIHBhY2thZ2Ugd2FzIGZvdW5kIG9uIHRoZSBkZXZpY2UgYW5kXG4gKiAgICAgICAgICAgICAgICAgICBzdWNjZXNzZnVsbHkgdW5pbnN0YWxsZWQuXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy51bmluc3RhbGxBcGsgPSBhc3luYyBmdW5jdGlvbiB1bmluc3RhbGxBcGsgKHBrZywgb3B0aW9ucyA9IHt9KSB7XG4gIGxvZy5kZWJ1ZyhgVW5pbnN0YWxsaW5nICR7cGtnfWApO1xuICBpZiAoIWF3YWl0IHRoaXMuaXNBcHBJbnN0YWxsZWQocGtnKSkge1xuICAgIGxvZy5pbmZvKGAke3BrZ30gd2FzIG5vdCB1bmluc3RhbGxlZCwgYmVjYXVzZSBpdCB3YXMgbm90IHByZXNlbnQgb24gdGhlIGRldmljZWApO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGNvbnN0IGNtZCA9IFsndW5pbnN0YWxsJ107XG4gIGlmIChvcHRpb25zLmtlZXBEYXRhKSB7XG4gICAgY21kLnB1c2goJy1rJyk7XG4gIH1cbiAgY21kLnB1c2gocGtnKTtcblxuICBsZXQgc3Rkb3V0O1xuICB0cnkge1xuICAgIGF3YWl0IHRoaXMuZm9yY2VTdG9wKHBrZyk7XG4gICAgc3Rkb3V0ID0gKGF3YWl0IHRoaXMuYWRiRXhlYyhjbWQsIHt0aW1lb3V0OiBvcHRpb25zLnRpbWVvdXR9KSkudHJpbSgpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBVbmFibGUgdG8gdW5pbnN0YWxsIEFQSy4gT3JpZ2luYWwgZXJyb3I6ICR7ZS5tZXNzYWdlfWApO1xuICB9XG4gIGxvZy5kZWJ1ZyhgJ2FkYiAke2NtZC5qb2luKCcgJyl9JyBjb21tYW5kIG91dHB1dDogJHtzdGRvdXR9YCk7XG4gIGlmIChzdGRvdXQuaW5jbHVkZXMoJ1N1Y2Nlc3MnKSkge1xuICAgIGxvZy5pbmZvKGAke3BrZ30gd2FzIHN1Y2Nlc3NmdWxseSB1bmluc3RhbGxlZGApO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGxvZy5pbmZvKGAke3BrZ30gd2FzIG5vdCB1bmluc3RhbGxlZGApO1xuICByZXR1cm4gZmFsc2U7XG59O1xuXG4vKipcbiAqIEluc3RhbGwgdGhlIHBhY2thZ2UgYWZ0ZXIgaXQgd2FzIHB1c2hlZCB0byB0aGUgZGV2aWNlIHVuZGVyIHRlc3QuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGFwa1BhdGhPbkRldmljZSAtIFRoZSBmdWxsIHBhdGggdG8gdGhlIHBhY2thZ2Ugb24gdGhlIGRldmljZSBmaWxlIHN5c3RlbS5cbiAqIEBwYXJhbSB7b2JqZWN0fSBvcHRzIFt7fV0gLSBBZGRpdGlvbmFsIGV4ZWMgb3B0aW9ucy4gU2VlIHtAbGluayBodHRwczovL2dpdGh1Yi5jb20vYXBwaXVtL25vZGUtdGVlbl9wcm9jZXNzfVxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBtb3JlIGRldGFpbHMgb24gdGhpcyBwYXJhbWV0ZXIuXG4gKiBAdGhyb3dzIHtlcnJvcn0gSWYgdGhlcmUgd2FzIGEgZmFpbHVyZSBkdXJpbmcgYXBwbGljYXRpb24gaW5zdGFsbC5cbiAqL1xuYXBrVXRpbHNNZXRob2RzLmluc3RhbGxGcm9tRGV2aWNlUGF0aCA9IGFzeW5jIGZ1bmN0aW9uIGluc3RhbGxGcm9tRGV2aWNlUGF0aCAoYXBrUGF0aE9uRGV2aWNlLCBvcHRzID0ge30pIHtcbiAgbGV0IHN0ZG91dCA9IGF3YWl0IHRoaXMuc2hlbGwoWydwbScsICdpbnN0YWxsJywgJy1yJywgYXBrUGF0aE9uRGV2aWNlXSwgb3B0cyk7XG4gIGlmIChzdGRvdXQuaW5kZXhPZignRmFpbHVyZScpICE9PSAtMSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgUmVtb3RlIGluc3RhbGwgZmFpbGVkOiAke3N0ZG91dH1gKTtcbiAgfVxufTtcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBDYWNoaW5nT3B0aW9uc1xuICogQHByb3BlcnR5IHs/bnVtYmVyfSB0aW1lb3V0IFthZGJFeGVjVGltZW91dF0gLSBUaGUgY291bnQgb2YgbWlsbGlzZWNvbmRzIHRvIHdhaXQgdW50aWwgdGhlXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcCBpcyB1cGxvYWRlZCB0byB0aGUgcmVtb3RlIGxvY2F0aW9uLlxuICovXG5cbi8qKlxuICogQ2FjaGVzIHRoZSBnaXZlbiBBUEsgYXQgYSByZW1vdGUgbG9jYXRpb24gdG8gc3BlZWQgdXAgZnVydGhlciBBUEsgZGVwbG95bWVudHMuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGFwa1BhdGggLSBGdWxsIHBhdGggdG8gdGhlIGFwayBvbiB0aGUgbG9jYWwgRlNcbiAqIEBwYXJhbSB7P0NhY2hpbmdPcHRpb25zfSBvcHRpb25zIC0gQ2FjaGluZyBvcHRpb25zXG4gKiBAcmV0dXJucyB7c3RyaW5nfSAtIEZ1bGwgcGF0aCB0byB0aGUgY2FjaGVkIGFwayBvbiB0aGUgcmVtb3RlIGZpbGUgc3lzdGVtXG4gKiBAdGhyb3dzIHtFcnJvcn0gaWYgdGhlcmUgd2FzIGEgZmFpbHVyZSB3aGlsZSBjYWNoaW5nIHRoZSBhcHBcbiAqL1xuYXBrVXRpbHNNZXRob2RzLmNhY2hlQXBrID0gYXN5bmMgZnVuY3Rpb24gY2FjaGVBcGsgKGFwa1BhdGgsIG9wdGlvbnMgPSB7fSkge1xuICBjb25zdCBhcHBIYXNoID0gYXdhaXQgZnMuaGFzaChhcGtQYXRoKTtcbiAgY29uc3QgcmVtb3RlUGF0aCA9IHBhdGgucG9zaXguam9pbihSRU1PVEVfQ0FDSEVfUk9PVCwgYCR7YXBwSGFzaH0uYXBrYCk7XG4gIGNvbnN0IHJlbW90ZUNhY2hlZEZpbGVzID0gW107XG4gIC8vIEdldCBjdXJyZW50IGNvbnRlbnRzIG9mIHRoZSByZW1vdGUgY2FjaGUgb3IgY3JlYXRlIGl0IGZvciB0aGUgZmlyc3QgdGltZVxuICB0cnkge1xuICAgIGNvbnN0IGVycm9yTWFya2VyID0gJ19FUlJPUl8nO1xuICAgIGxldCBsc091dHB1dCA9IG51bGw7XG4gICAgaWYgKHRoaXMuX2FyZUV4dGVuZGVkTHNPcHRpb25zU3VwcG9ydGVkID09PSB0cnVlIHx8ICFfLmlzQm9vbGVhbih0aGlzLl9hcmVFeHRlbmRlZExzT3B0aW9uc1N1cHBvcnRlZCkpIHtcbiAgICAgIGxzT3V0cHV0ID0gYXdhaXQgdGhpcy5zaGVsbChbYGxzIC10IC0xICR7UkVNT1RFX0NBQ0hFX1JPT1R9IDI+JjEgfHwgZWNobyAke2Vycm9yTWFya2VyfWBdKTtcbiAgICB9XG4gICAgaWYgKCFfLmlzU3RyaW5nKGxzT3V0cHV0KSB8fCAobHNPdXRwdXQuaW5jbHVkZXMoZXJyb3JNYXJrZXIpICYmICFsc091dHB1dC5pbmNsdWRlcyhSRU1PVEVfQ0FDSEVfUk9PVCkpKSB7XG4gICAgICBpZiAoIV8uaXNCb29sZWFuKHRoaXMuX2FyZUV4dGVuZGVkTHNPcHRpb25zU3VwcG9ydGVkKSkge1xuICAgICAgICBsb2cuZGVidWcoJ1RoZSBjdXJyZW50IEFuZHJvaWQgQVBJIGRvZXMgbm90IHN1cHBvcnQgZXh0ZW5kZWQgbHMgb3B0aW9ucy4gJyArXG4gICAgICAgICAgJ0RlZmF1bHRpbmcgdG8gbm8tb3B0aW9ucyBjYWxsJyk7XG4gICAgICB9XG4gICAgICBsc091dHB1dCA9IGF3YWl0IHRoaXMuc2hlbGwoW2BscyAke1JFTU9URV9DQUNIRV9ST09UfSAyPiYxIHx8IGVjaG8gJHtlcnJvck1hcmtlcn1gXSk7XG4gICAgICB0aGlzLl9hcmVFeHRlbmRlZExzT3B0aW9uc1N1cHBvcnRlZCA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9hcmVFeHRlbmRlZExzT3B0aW9uc1N1cHBvcnRlZCA9IHRydWU7XG4gICAgfVxuICAgIGlmIChsc091dHB1dC5pbmNsdWRlcyhlcnJvck1hcmtlcikpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihsc091dHB1dC5zdWJzdHJpbmcoMCwgbHNPdXRwdXQuaW5kZXhPZihlcnJvck1hcmtlcikpKTtcbiAgICB9XG4gICAgcmVtb3RlQ2FjaGVkRmlsZXMucHVzaCguLi4oXG4gICAgICBsc091dHB1dC5zcGxpdCgnXFxuJylcbiAgICAgICAgLm1hcCgoeCkgPT4geC50cmltKCkpXG4gICAgICAgIC5maWx0ZXIoQm9vbGVhbilcbiAgICApKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGxvZy5kZWJ1ZyhgR290IGFuIGVycm9yICcke2UubWVzc2FnZS50cmltKCl9JyB3aGlsZSBnZXR0aW5nIHRoZSBsaXN0IG9mIGZpbGVzIGluIHRoZSBjYWNoZS4gYCArXG4gICAgICBgQXNzdW1pbmcgdGhlIGNhY2hlIGRvZXMgbm90IGV4aXN0IHlldGApO1xuICAgIGF3YWl0IHRoaXMuc2hlbGwoWydta2RpcicsICctcCcsIFJFTU9URV9DQUNIRV9ST09UXSk7XG4gIH1cbiAgbG9nLmRlYnVnKGBUaGUgY291bnQgb2YgYXBwbGljYXRpb25zIGluIHRoZSBjYWNoZTogJHtyZW1vdGVDYWNoZWRGaWxlcy5sZW5ndGh9YCk7XG4gIGNvbnN0IHRvSGFzaCA9IChyZW1vdGVQYXRoKSA9PiBwYXRoLnBvc2l4LnBhcnNlKHJlbW90ZVBhdGgpLm5hbWU7XG4gIC8vIFB1c2ggdGhlIGFwayB0byB0aGUgcmVtb3RlIGNhY2hlIGlmIG5lZWRlZFxuICBpZiAocmVtb3RlQ2FjaGVkRmlsZXMuc29tZSgoeCkgPT4gdG9IYXNoKHgpID09PSBhcHBIYXNoKSkge1xuICAgIGxvZy5pbmZvKGBUaGUgYXBwbGljYXRpb24gYXQgJyR7YXBrUGF0aH0nIGlzIGFscmVhZHkgY2FjaGVkIHRvICcke3JlbW90ZVBhdGh9J2ApO1xuICAgIC8vIFVwZGF0ZSB0aGUgYXBwbGljYXRpb24gdGltZXN0YW1wIGFzeW5jaHJvbm91c2x5IGluIG9yZGVyIHRvIGJ1bXAgaXRzIHBvc2l0aW9uXG4gICAgLy8gaW4gdGhlIHNvcnRlZCBscyBvdXRwdXRcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJvbWlzZS9wcmVmZXItYXdhaXQtdG8tdGhlblxuICAgIHRoaXMuc2hlbGwoWyd0b3VjaCcsICctYW0nLCByZW1vdGVQYXRoXSkuY2F0Y2goKCkgPT4ge30pO1xuICB9IGVsc2Uge1xuICAgIGxvZy5pbmZvKGBDYWNoaW5nIHRoZSBhcHBsaWNhdGlvbiBhdCAnJHthcGtQYXRofScgdG8gJyR7cmVtb3RlUGF0aH0nYCk7XG4gICAgY29uc3QgdGltZXIgPSBuZXcgdGltaW5nLlRpbWVyKCkuc3RhcnQoKTtcbiAgICBhd2FpdCB0aGlzLnB1c2goYXBrUGF0aCwgcmVtb3RlUGF0aCwge3RpbWVvdXQ6IG9wdGlvbnMudGltZW91dH0pO1xuICAgIGNvbnN0IHtzaXplfSA9IGF3YWl0IGZzLnN0YXQoYXBrUGF0aCk7XG4gICAgbG9nLmluZm8oYFRoZSB1cGxvYWQgb2YgJyR7cGF0aC5iYXNlbmFtZShhcGtQYXRoKX0nICgke3V0aWwudG9SZWFkYWJsZVNpemVTdHJpbmcoc2l6ZSl9KSBgICtcbiAgICAgIGB0b29rICR7dGltZXIuZ2V0RHVyYXRpb24oKS5hc01pbGxpU2Vjb25kcy50b0ZpeGVkKDApfW1zYCk7XG4gIH1cbiAgaWYgKCF0aGlzLnJlbW90ZUFwcHNDYWNoZSkge1xuICAgIHRoaXMucmVtb3RlQXBwc0NhY2hlID0gbmV3IExSVSh7XG4gICAgICBtYXg6IHRoaXMucmVtb3RlQXBwc0NhY2hlTGltaXQsXG4gICAgfSk7XG4gIH1cbiAgLy8gQ2xlYW51cCB0aGUgaW52YWxpZCBlbnRyaWVzIGZyb20gdGhlIGNhY2hlXG4gIF8uZGlmZmVyZW5jZShbLi4udGhpcy5yZW1vdGVBcHBzQ2FjaGUua2V5cygpXSwgcmVtb3RlQ2FjaGVkRmlsZXMubWFwKHRvSGFzaCkpXG4gICAgLmZvckVhY2goKGhhc2gpID0+IHRoaXMucmVtb3RlQXBwc0NhY2hlLmRlbChoYXNoKSk7XG4gIC8vIEJ1bXAgdGhlIGNhY2hlIHJlY29yZCBmb3IgdGhlIHJlY2VudGx5IGNhY2hlZCBpdGVtXG4gIHRoaXMucmVtb3RlQXBwc0NhY2hlLnNldChhcHBIYXNoLCByZW1vdGVQYXRoKTtcbiAgLy8gSWYgdGhlIHJlbW90ZSBjYWNoZSBleGNlZWRzIHRoaXMucmVtb3RlQXBwc0NhY2hlTGltaXQsIHJlbW92ZSB0aGUgbGVhc3QgcmVjZW50bHkgdXNlZCBlbnRyaWVzXG4gIGNvbnN0IGVudHJpZXNUb0NsZWFudXAgPSByZW1vdGVDYWNoZWRGaWxlc1xuICAgIC5tYXAoKHgpID0+IHBhdGgucG9zaXguam9pbihSRU1PVEVfQ0FDSEVfUk9PVCwgeCkpXG4gICAgLmZpbHRlcigoeCkgPT4gIXRoaXMucmVtb3RlQXBwc0NhY2hlLmhhcyh0b0hhc2goeCkpKVxuICAgIC5zbGljZSh0aGlzLnJlbW90ZUFwcHNDYWNoZUxpbWl0IC0gWy4uLnRoaXMucmVtb3RlQXBwc0NhY2hlLmtleXMoKV0ubGVuZ3RoKTtcbiAgaWYgKCFfLmlzRW1wdHkoZW50cmllc1RvQ2xlYW51cCkpIHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5zaGVsbChbJ3JtJywgJy1mJywgLi4uZW50cmllc1RvQ2xlYW51cF0pO1xuICAgICAgbG9nLmRlYnVnKGBEZWxldGVkICR7ZW50cmllc1RvQ2xlYW51cC5sZW5ndGh9IGV4cGlyZWQgYXBwbGljYXRpb24gY2FjaGUgZW50cmllc2ApO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGxvZy53YXJuKGBDYW5ub3QgZGVsZXRlICR7ZW50cmllc1RvQ2xlYW51cC5sZW5ndGh9IGV4cGlyZWQgYXBwbGljYXRpb24gY2FjaGUgZW50cmllcy4gYCArXG4gICAgICAgIGBPcmlnaW5hbCBlcnJvcjogJHtlLm1lc3NhZ2V9YCk7XG4gICAgfVxuICB9XG4gIHJldHVybiByZW1vdGVQYXRoO1xufTtcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBJbnN0YWxsT3B0aW9uc1xuICogQHByb3BlcnR5IHtudW1iZXJ9IHRpbWVvdXQgWzYwMDAwXSAtIFRoZSBjb3VudCBvZiBtaWxsaXNlY29uZHMgdG8gd2FpdCB1bnRpbCB0aGVcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHAgaXMgaW5zdGFsbGVkLlxuICogQHByb3BlcnR5IHtzdHJpbmd9IHRpbWVvdXRDYXBOYW1lIFthbmRyb2lkSW5zdGFsbFRpbWVvdXRdIC0gVGhlIHRpbWVvdXQgb3B0aW9uIG5hbWVcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJzIGNhbiBpbmNyZWFzZSB0aGUgdGltZW91dC5cbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gYWxsb3dUZXN0UGFja2FnZXMgW2ZhbHNlXSAtIFNldCB0byB0cnVlIGluIG9yZGVyIHRvIGFsbG93IHRlc3RcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhY2thZ2VzIGluc3RhbGxhdGlvbi5cbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gdXNlU2RjYXJkIFtmYWxzZV0gLSBTZXQgdG8gdHJ1ZSB0byBpbnN0YWxsIHRoZSBhcHAgb24gc2RjYXJkXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGVhZCBvZiB0aGUgZGV2aWNlIG1lbW9yeS5cbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gZ3JhbnRQZXJtaXNzaW9ucyBbZmFsc2VdIC0gU2V0IHRvIHRydWUgaW4gb3JkZXIgdG8gZ3JhbnQgYWxsIHRoZVxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZXJtaXNzaW9ucyByZXF1ZXN0ZWQgaW4gdGhlIGFwcGxpY2F0aW9uJ3MgbWFuaWZlc3RcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0b21hdGljYWxseSBhZnRlciB0aGUgaW5zdGFsbGF0aW9uIGlzIGNvbXBsZXRlZFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bmRlciBBbmRyb2lkIDYrLlxuICogQHByb3BlcnR5IHtib29sZWFufSByZXBsYWNlIFt0cnVlXSAtIFNldCBpdCB0byBmYWxzZSBpZiB5b3UgZG9uJ3Qgd2FudFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZSBhcHBsaWNhdGlvbiB0byBiZSB1cGdyYWRlZC9yZWluc3RhbGxlZFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIGl0IGlzIGFscmVhZHkgcHJlc2VudCBvbiB0aGUgZGV2aWNlLlxuICogQHByb3BlcnR5IHtib29sZWFufSBub0luY3JlbWVudGFsIFtmYWxzZV0gLSBGb3JjZWZ1bGx5IGRpc2FibGVzIGluY3JlbWVudGFsIGluc3RhbGxzIGlmIHNldCB0byBgdHJ1ZWAuXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlYWQgaHR0cHM6Ly9kZXZlbG9wZXIuYW5kcm9pZC5jb20vcHJldmlldy9mZWF0dXJlcyNpbmNyZW1lbnRhbFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgbW9yZSBkZXRhaWxzLlxuICovXG5cbi8qKlxuICogSW5zdGFsbCB0aGUgcGFja2FnZSBmcm9tIHRoZSBsb2NhbCBmaWxlIHN5c3RlbS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gYXBwUGF0aCAtIFRoZSBmdWxsIHBhdGggdG8gdGhlIGxvY2FsIHBhY2thZ2UuXG4gKiBAcGFyYW0gez9JbnN0YWxsT3B0aW9uc30gb3B0aW9ucyAtIFRoZSBzZXQgb2YgaW5zdGFsbGF0aW9uIG9wdGlvbnMuXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgYW4gdW5leHBlY3RlZCBlcnJvciBoYXBwZW5zIGR1cmluZyBpbnN0YWxsLlxuICovXG5hcGtVdGlsc01ldGhvZHMuaW5zdGFsbCA9IGFzeW5jIGZ1bmN0aW9uIGluc3RhbGwgKGFwcFBhdGgsIG9wdGlvbnMgPSB7fSkge1xuICBpZiAoYXBwUGF0aC5lbmRzV2l0aChBUEtTX0VYVEVOU0lPTikpIHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5pbnN0YWxsQXBrcyhhcHBQYXRoLCBvcHRpb25zKTtcbiAgfVxuXG4gIG9wdGlvbnMgPSBfLmNsb25lRGVlcChvcHRpb25zKTtcbiAgXy5kZWZhdWx0cyhvcHRpb25zLCB7XG4gICAgcmVwbGFjZTogdHJ1ZSxcbiAgICB0aW1lb3V0OiB0aGlzLmFkYkV4ZWNUaW1lb3V0ID09PSBERUZBVUxUX0FEQl9FWEVDX1RJTUVPVVQgPyBBUEtfSU5TVEFMTF9USU1FT1VUIDogdGhpcy5hZGJFeGVjVGltZW91dCxcbiAgICB0aW1lb3V0Q2FwTmFtZTogJ2FuZHJvaWRJbnN0YWxsVGltZW91dCcsXG4gIH0pO1xuXG4gIGNvbnN0IGluc3RhbGxBcmdzID0gYnVpbGRJbnN0YWxsQXJncyhhd2FpdCB0aGlzLmdldEFwaUxldmVsKCksIG9wdGlvbnMpO1xuICBpZiAob3B0aW9ucy5ub0luY3JlbWVudGFsICYmIGF3YWl0IHRoaXMuaXNJbmNyZW1lbnRhbEluc3RhbGxTdXBwb3J0ZWQoKSkge1xuICAgIC8vIEFkYiB0aHJvd3MgYW4gZXJyb3IgaWYgaXQgZG9lcyBub3Qga25vdyBhYm91dCBhbiBhcmcsXG4gICAgLy8gd2hpY2ggaXMgdGhlIGNhc2UgaGVyZSBmb3Igb2xkZXIgYWRiIHZlcnNpb25zLlxuICAgIGluc3RhbGxBcmdzLnB1c2goJy0tbm8taW5jcmVtZW50YWwnKTtcbiAgfVxuICBjb25zdCBpbnN0YWxsT3B0cyA9IHtcbiAgICB0aW1lb3V0OiBvcHRpb25zLnRpbWVvdXQsXG4gICAgdGltZW91dENhcE5hbWU6IG9wdGlvbnMudGltZW91dENhcE5hbWUsXG4gIH07XG4gIGNvbnN0IGluc3RhbGxDbWQgPSBbXG4gICAgJ2luc3RhbGwnLFxuICAgIC4uLmluc3RhbGxBcmdzLFxuICAgIGFwcFBhdGgsXG4gIF07XG4gIGxldCBwZXJmb3JtQXBwSW5zdGFsbCA9IGFzeW5jICgpID0+IGF3YWl0IHRoaXMuYWRiRXhlYyhpbnN0YWxsQ21kLCBpbnN0YWxsT3B0cyk7XG4gIC8vIHRoaXMucmVtb3RlQXBwc0NhY2hlTGltaXQgPD0gMCBtZWFucyBubyBjYWNoaW5nIHNob3VsZCBiZSBhcHBsaWVkXG4gIGxldCBzaG91bGRDYWNoZUFwcCA9IHRoaXMucmVtb3RlQXBwc0NhY2hlTGltaXQgPiAwO1xuICBpZiAoc2hvdWxkQ2FjaGVBcHApIHtcbiAgICBzaG91bGRDYWNoZUFwcCA9ICEoYXdhaXQgdGhpcy5pc1N0cmVhbWVkSW5zdGFsbFN1cHBvcnRlZCgpKTtcbiAgICBpZiAoIXNob3VsZENhY2hlQXBwKSB7XG4gICAgICBsb2cuaW5mbyhgVGhlIGFwcGxpY2F0aW9uIGF0ICcke2FwcFBhdGh9JyB3aWxsIG5vdCBiZSBjYWNoZWQsIGJlY2F1c2UgdGhlIGRldmljZSB1bmRlciB0ZXN0IGhhcyBgICtcbiAgICAgICAgYGNvbmZpcm1lZCB0aGUgc3VwcG9ydCBvZiBzdHJlYW1lZCBpbnN0YWxsc2ApO1xuICAgIH1cbiAgfVxuICBpZiAoc2hvdWxkQ2FjaGVBcHApIHtcbiAgICBjb25zdCBjbGVhckNhY2hlID0gYXN5bmMgKCkgPT4ge1xuICAgICAgbG9nLmluZm8oYENsZWFyaW5nIHRoZSBjYWNoZSBhdCAnJHtSRU1PVEVfQ0FDSEVfUk9PVH0nYCk7XG4gICAgICBhd2FpdCB0aGlzLnNoZWxsKFsncm0nLCAnLXJmJywgYCR7UkVNT1RFX0NBQ0hFX1JPT1R9LypgXSk7XG4gICAgfTtcbiAgICBjb25zdCBjYWNoZUFwcCA9IGFzeW5jICgpID0+IGF3YWl0IHRoaXMuY2FjaGVBcGsoYXBwUGF0aCwge1xuICAgICAgdGltZW91dDogb3B0aW9ucy50aW1lb3V0LFxuICAgIH0pO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjYWNoZWRBcHBQYXRoID0gYXdhaXQgY2FjaGVBcHAoKTtcbiAgICAgIHBlcmZvcm1BcHBJbnN0YWxsID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBwbUluc3RhbGxDbWRCeVJlbW90ZVBhdGggPSAocmVtb3RlUGF0aCkgPT4gW1xuICAgICAgICAgICdwbScsICdpbnN0YWxsJyxcbiAgICAgICAgICAuLi5pbnN0YWxsQXJncyxcbiAgICAgICAgICByZW1vdGVQYXRoLFxuICAgICAgICBdO1xuICAgICAgICBjb25zdCBvdXRwdXQgPSBhd2FpdCB0aGlzLnNoZWxsKHBtSW5zdGFsbENtZEJ5UmVtb3RlUGF0aChjYWNoZWRBcHBQYXRoKSwgaW5zdGFsbE9wdHMpO1xuICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vYXBwaXVtL2FwcGl1bS9pc3N1ZXMvMTM5NzBcbiAgICAgICAgaWYgKC9cXGJJTlNUQUxMX0ZBSUxFRF9JTlNVRkZJQ0lFTlRfU1RPUkFHRVxcYi8udGVzdChvdXRwdXQpKSB7XG4gICAgICAgICAgbG9nLndhcm4oYFRoZXJlIHdhcyBhIGZhaWx1cmUgd2hpbGUgaW5zdGFsbGluZyAnJHthcHBQYXRofScgYCArXG4gICAgICAgICAgICBgYmVjYXVzZSBvZiB0aGUgaW5zdWZmaWNpZW50IGRldmljZSBzdG9yYWdlIHNwYWNlYCk7XG4gICAgICAgICAgYXdhaXQgY2xlYXJDYWNoZSgpO1xuICAgICAgICAgIGxvZy5pbmZvKGBDb25zaWRlciBkZWNyZWFzaW5nIHRoZSBtYXhpbXVtIGFtb3VudCBvZiBjYWNoZWQgYXBwcyBgICtcbiAgICAgICAgICAgIGAoY3VycmVudGx5ICR7dGhpcy5yZW1vdGVBcHBzQ2FjaGVMaW1pdH0pIHRvIGF2b2lkIHN1Y2ggaXNzdWVzIGluIHRoZSBmdXR1cmVgKTtcbiAgICAgICAgICBjb25zdCBuZXdDYWNoZWRBcHBQYXRoID0gYXdhaXQgY2FjaGVBcHAoKTtcbiAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5zaGVsbChwbUluc3RhbGxDbWRCeVJlbW90ZVBhdGgobmV3Q2FjaGVkQXBwUGF0aCksIGluc3RhbGxPcHRzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgICAgfTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBsb2cuZGVidWcoZSk7XG4gICAgICBsb2cud2FybihgVGhlcmUgd2FzIGEgZmFpbHVyZSB3aGlsZSBjYWNoaW5nICcke2FwcFBhdGh9JzogJHtlLm1lc3NhZ2V9YCk7XG4gICAgICBsb2cud2FybignRmFsbGluZyBiYWNrIHRvIHRoZSBkZWZhdWx0IGluc3RhbGxhdGlvbiBwcm9jZWR1cmUnKTtcbiAgICAgIGF3YWl0IGNsZWFyQ2FjaGUoKTtcbiAgICB9XG4gIH1cbiAgdHJ5IHtcbiAgICBjb25zdCB0aW1lciA9IG5ldyB0aW1pbmcuVGltZXIoKS5zdGFydCgpO1xuICAgIGNvbnN0IG91dHB1dCA9IGF3YWl0IHBlcmZvcm1BcHBJbnN0YWxsKCk7XG4gICAgbG9nLmluZm8oYFRoZSBpbnN0YWxsYXRpb24gb2YgJyR7cGF0aC5iYXNlbmFtZShhcHBQYXRoKX0nIHRvb2sgJHt0aW1lci5nZXREdXJhdGlvbigpLmFzTWlsbGlTZWNvbmRzLnRvRml4ZWQoMCl9bXNgKTtcbiAgICBjb25zdCB0cnVuY2F0ZWRPdXRwdXQgPSAoIV8uaXNTdHJpbmcob3V0cHV0KSB8fCBvdXRwdXQubGVuZ3RoIDw9IDMwMCkgP1xuICAgICAgb3V0cHV0IDogYCR7b3V0cHV0LnN1YnN0cigwLCAxNTApfS4uLiR7b3V0cHV0LnN1YnN0cihvdXRwdXQubGVuZ3RoIC0gMTUwKX1gO1xuICAgIGxvZy5kZWJ1ZyhgSW5zdGFsbCBjb21tYW5kIHN0ZG91dDogJHt0cnVuY2F0ZWRPdXRwdXR9YCk7XG4gICAgaWYgKC9cXFtJTlNUQUxMW0EtWl9dK0ZBSUxFRFtBLVpfXStcXF0vLnRlc3Qob3V0cHV0KSkge1xuICAgICAgaWYgKHRoaXMuaXNUZXN0UGFja2FnZU9ubHlFcnJvcihvdXRwdXQpKSB7XG4gICAgICAgIGNvbnN0IG1zZyA9IGBTZXQgJ2FsbG93VGVzdFBhY2thZ2VzJyBjYXBhYmlsaXR5IHRvIHRydWUgaW4gb3JkZXIgdG8gYWxsb3cgdGVzdCBwYWNrYWdlcyBpbnN0YWxsYXRpb24uYDtcbiAgICAgICAgbG9nLndhcm4obXNnKTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAke291dHB1dH1cXG4ke21zZ31gKTtcbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBFcnJvcihvdXRwdXQpO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgLy8gb24gc29tZSBzeXN0ZW1zIHRoaXMgd2lsbCB0aHJvdyBhbiBlcnJvciBpZiB0aGUgYXBwIGFscmVhZHlcbiAgICAvLyBleGlzdHNcbiAgICBpZiAoIWVyci5tZXNzYWdlLmluY2x1ZGVzKCdJTlNUQUxMX0ZBSUxFRF9BTFJFQURZX0VYSVNUUycpKSB7XG4gICAgICB0aHJvdyBlcnI7XG4gICAgfVxuICAgIGxvZy5kZWJ1ZyhgQXBwbGljYXRpb24gJyR7YXBwUGF0aH0nIGFscmVhZHkgaW5zdGFsbGVkLiBDb250aW51aW5nLmApO1xuICB9XG59O1xuXG4vKipcbiAqIFJldHJpZXZlcyB0aGUgY3VycmVudCBpbnN0YWxsYXRpb24gc3RhdGUgb2YgdGhlIHBhcnRpY3VsYXIgYXBwbGljYXRpb25cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gYXBwUGF0aCAtIEZ1bGwgcGF0aCB0byB0aGUgYXBwbGljYXRpb25cbiAqIEBwYXJhbSB7P3N0cmluZ30gcGtnIC0gUGFja2FnZSBpZGVudGlmaWVyLiBJZiBvbWl0dGVkIHRoZW4gdGhlIHNjcmlwdCB3aWxsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB0byBleHRyYWN0IGl0IG9uIGl0cyBvd25cbiAqIEByZXR1cm5zIHtzdHJpbmd9XU9uZSBvZiBgQVBQX0lOU1RBTExfU1RBVEVgIGNvbnN0YW50c1xuICovXG5hcGtVdGlsc01ldGhvZHMuZ2V0QXBwbGljYXRpb25JbnN0YWxsU3RhdGUgPSBhc3luYyBmdW5jdGlvbiBnZXRBcHBsaWNhdGlvbkluc3RhbGxTdGF0ZSAoYXBwUGF0aCwgcGtnID0gbnVsbCkge1xuICBsZXQgYXBrSW5mbyA9IG51bGw7XG4gIGlmICghcGtnKSB7XG4gICAgYXBrSW5mbyA9IGF3YWl0IHRoaXMuZ2V0QXBrSW5mbyhhcHBQYXRoKTtcbiAgICBwa2cgPSBhcGtJbmZvLm5hbWU7XG4gIH1cbiAgaWYgKCFwa2cpIHtcbiAgICBsb2cud2FybihgQ2Fubm90IHJlYWQgdGhlIHBhY2thZ2UgbmFtZSBvZiAnJHthcHBQYXRofSdgKTtcbiAgICByZXR1cm4gdGhpcy5BUFBfSU5TVEFMTF9TVEFURS5VTktOT1dOO1xuICB9XG5cbiAgaWYgKCFhd2FpdCB0aGlzLmlzQXBwSW5zdGFsbGVkKHBrZykpIHtcbiAgICBsb2cuZGVidWcoYEFwcCAnJHthcHBQYXRofScgaXMgbm90IGluc3RhbGxlZGApO1xuICAgIHJldHVybiB0aGlzLkFQUF9JTlNUQUxMX1NUQVRFLk5PVF9JTlNUQUxMRUQ7XG4gIH1cblxuICBjb25zdCB7dmVyc2lvbkNvZGU6IHBrZ1ZlcnNpb25Db2RlLCB2ZXJzaW9uTmFtZTogcGtnVmVyc2lvbk5hbWVTdHJ9ID0gYXdhaXQgdGhpcy5nZXRQYWNrYWdlSW5mbyhwa2cpO1xuICBjb25zdCBwa2dWZXJzaW9uTmFtZSA9IHNlbXZlci52YWxpZChzZW12ZXIuY29lcmNlKHBrZ1ZlcnNpb25OYW1lU3RyKSk7XG4gIGlmICghYXBrSW5mbykge1xuICAgIGFwa0luZm8gPSBhd2FpdCB0aGlzLmdldEFwa0luZm8oYXBwUGF0aCk7XG4gIH1cbiAgY29uc3Qge3ZlcnNpb25Db2RlOiBhcGtWZXJzaW9uQ29kZSwgdmVyc2lvbk5hbWU6IGFwa1ZlcnNpb25OYW1lU3RyfSA9IGFwa0luZm87XG4gIGNvbnN0IGFwa1ZlcnNpb25OYW1lID0gc2VtdmVyLnZhbGlkKHNlbXZlci5jb2VyY2UoYXBrVmVyc2lvbk5hbWVTdHIpKTtcblxuICBpZiAoIV8uaXNJbnRlZ2VyKGFwa1ZlcnNpb25Db2RlKSB8fCAhXy5pc0ludGVnZXIocGtnVmVyc2lvbkNvZGUpKSB7XG4gICAgbG9nLndhcm4oYENhbm5vdCByZWFkIHZlcnNpb24gY29kZXMgb2YgJyR7YXBwUGF0aH0nIGFuZC9vciAnJHtwa2d9J2ApO1xuICAgIGlmICghXy5pc1N0cmluZyhhcGtWZXJzaW9uTmFtZSkgfHwgIV8uaXNTdHJpbmcocGtnVmVyc2lvbk5hbWUpKSB7XG4gICAgICBsb2cud2FybihgQ2Fubm90IHJlYWQgdmVyc2lvbiBuYW1lcyBvZiAnJHthcHBQYXRofScgYW5kL29yICcke3BrZ30nYCk7XG4gICAgICByZXR1cm4gdGhpcy5BUFBfSU5TVEFMTF9TVEFURS5VTktOT1dOO1xuICAgIH1cbiAgfVxuICBpZiAoXy5pc0ludGVnZXIoYXBrVmVyc2lvbkNvZGUpICYmIF8uaXNJbnRlZ2VyKHBrZ1ZlcnNpb25Db2RlKSkge1xuICAgIGlmIChwa2dWZXJzaW9uQ29kZSA+IGFwa1ZlcnNpb25Db2RlKSB7XG4gICAgICBsb2cuZGVidWcoYFRoZSB2ZXJzaW9uIGNvZGUgb2YgdGhlIGluc3RhbGxlZCAnJHtwa2d9JyBpcyBncmVhdGVyIHRoYW4gdGhlIGFwcGxpY2F0aW9uIHZlcnNpb24gY29kZSAoJHtwa2dWZXJzaW9uQ29kZX0gPiAke2Fwa1ZlcnNpb25Db2RlfSlgKTtcbiAgICAgIHJldHVybiB0aGlzLkFQUF9JTlNUQUxMX1NUQVRFLk5FV0VSX1ZFUlNJT05fSU5TVEFMTEVEO1xuICAgIH1cbiAgICAvLyBWZXJzaW9uIGNvZGVzIG1pZ2h0IG5vdCBiZSBtYWludGFpbmVkLiBDaGVjayB2ZXJzaW9uIG5hbWVzLlxuICAgIGlmIChwa2dWZXJzaW9uQ29kZSA9PT0gYXBrVmVyc2lvbkNvZGUpIHtcbiAgICAgIGlmIChfLmlzU3RyaW5nKGFwa1ZlcnNpb25OYW1lKSAmJiBfLmlzU3RyaW5nKHBrZ1ZlcnNpb25OYW1lKSAmJiBzZW12ZXIuc2F0aXNmaWVzKHBrZ1ZlcnNpb25OYW1lLCBgPj0ke2Fwa1ZlcnNpb25OYW1lfWApKSB7XG4gICAgICAgIGxvZy5kZWJ1ZyhgVGhlIHZlcnNpb24gbmFtZSBvZiB0aGUgaW5zdGFsbGVkICcke3BrZ30nIGlzIGdyZWF0ZXIgb3IgZXF1YWwgdG8gdGhlIGFwcGxpY2F0aW9uIHZlcnNpb24gbmFtZSAoJyR7cGtnVmVyc2lvbk5hbWV9JyA+PSAnJHthcGtWZXJzaW9uTmFtZX0nKWApO1xuICAgICAgICByZXR1cm4gc2VtdmVyLnNhdGlzZmllcyhwa2dWZXJzaW9uTmFtZSwgYD4ke2Fwa1ZlcnNpb25OYW1lfWApXG4gICAgICAgICAgPyB0aGlzLkFQUF9JTlNUQUxMX1NUQVRFLk5FV0VSX1ZFUlNJT05fSU5TVEFMTEVEXG4gICAgICAgICAgOiB0aGlzLkFQUF9JTlNUQUxMX1NUQVRFLlNBTUVfVkVSU0lPTl9JTlNUQUxMRUQ7XG4gICAgICB9XG4gICAgICBpZiAoIV8uaXNTdHJpbmcoYXBrVmVyc2lvbk5hbWUpIHx8ICFfLmlzU3RyaW5nKHBrZ1ZlcnNpb25OYW1lKSkge1xuICAgICAgICBsb2cuZGVidWcoYFRoZSB2ZXJzaW9uIG5hbWUgb2YgdGhlIGluc3RhbGxlZCAnJHtwa2d9JyBpcyBlcXVhbCB0byBhcHBsaWNhdGlvbiB2ZXJzaW9uIG5hbWUgKCR7cGtnVmVyc2lvbkNvZGV9ID09PSAke2Fwa1ZlcnNpb25Db2RlfSlgKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuQVBQX0lOU1RBTExfU1RBVEUuU0FNRV9WRVJTSU9OX0lOU1RBTExFRDtcbiAgICAgIH1cbiAgICB9XG4gIH0gZWxzZSBpZiAoXy5pc1N0cmluZyhhcGtWZXJzaW9uTmFtZSkgJiYgXy5pc1N0cmluZyhwa2dWZXJzaW9uTmFtZSkgJiYgc2VtdmVyLnNhdGlzZmllcyhwa2dWZXJzaW9uTmFtZSwgYD49JHthcGtWZXJzaW9uTmFtZX1gKSkge1xuICAgIGxvZy5kZWJ1ZyhgVGhlIHZlcnNpb24gbmFtZSBvZiB0aGUgaW5zdGFsbGVkICcke3BrZ30nIGlzIGdyZWF0ZXIgb3IgZXF1YWwgdG8gdGhlIGFwcGxpY2F0aW9uIHZlcnNpb24gbmFtZSAoJyR7cGtnVmVyc2lvbk5hbWV9JyA+PSAnJHthcGtWZXJzaW9uTmFtZX0nKWApO1xuICAgIHJldHVybiBzZW12ZXIuc2F0aXNmaWVzKHBrZ1ZlcnNpb25OYW1lLCBgPiR7YXBrVmVyc2lvbk5hbWV9YClcbiAgICAgID8gdGhpcy5BUFBfSU5TVEFMTF9TVEFURS5ORVdFUl9WRVJTSU9OX0lOU1RBTExFRFxuICAgICAgOiB0aGlzLkFQUF9JTlNUQUxMX1NUQVRFLlNBTUVfVkVSU0lPTl9JTlNUQUxMRUQ7XG4gIH1cblxuICBsb2cuZGVidWcoYFRoZSBpbnN0YWxsZWQgJyR7cGtnfScgcGFja2FnZSBpcyBvbGRlciB0aGFuICcke2FwcFBhdGh9JyAoJHtwa2dWZXJzaW9uQ29kZX0gPCAke2Fwa1ZlcnNpb25Db2RlfSBvciAnJHtwa2dWZXJzaW9uTmFtZX0nIDwgJyR7YXBrVmVyc2lvbk5hbWV9JyknYCk7XG4gIHJldHVybiB0aGlzLkFQUF9JTlNUQUxMX1NUQVRFLk9MREVSX1ZFUlNJT05fSU5TVEFMTEVEO1xufTtcblxuLyoqXG4gKiBAdHlwZWRlZiB7T2JqZWN0fSBJbnN0YWxsT3JVcGdyYWRlT3B0aW9uc1xuICogQHByb3BlcnR5IHtudW1iZXJ9IHRpbWVvdXQgWzYwMDAwXSAtIFRoZSBjb3VudCBvZiBtaWxsaXNlY29uZHMgdG8gd2FpdCB1bnRpbCB0aGVcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHAgaXMgaW5zdGFsbGVkLlxuICogQHByb3BlcnR5IHtib29sZWFufSBhbGxvd1Rlc3RQYWNrYWdlcyBbZmFsc2VdIC0gU2V0IHRvIHRydWUgaW4gb3JkZXIgdG8gYWxsb3cgdGVzdFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFja2FnZXMgaW5zdGFsbGF0aW9uLlxuICogQHByb3BlcnR5IHtib29sZWFufSB1c2VTZGNhcmQgW2ZhbHNlXSAtIFNldCB0byB0cnVlIHRvIGluc3RhbGwgdGhlIGFwcCBvbiBTRENhcmRcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnN0ZWFkIG9mIHRoZSBkZXZpY2UgbWVtb3J5LlxuICogQHByb3BlcnR5IHtib29sZWFufSBncmFudFBlcm1pc3Npb25zIFtmYWxzZV0gLSBTZXQgdG8gdHJ1ZSBpbiBvcmRlciB0byBncmFudCBhbGwgdGhlXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlcm1pc3Npb25zIHJlcXVlc3RlZCBpbiB0aGUgYXBwbGljYXRpb24ncyBtYW5pZmVzdFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRvbWF0aWNhbGx5IGFmdGVyIHRoZSBpbnN0YWxsYXRpb24gaXMgY29tcGxldGVkXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuZGVyIEFuZHJvaWQgNisuXG4gKiBAcHJvcGVydHkge2Jvb2xlYW59IGVuZm9yY2VDdXJyZW50QnVpbGQgW2ZhbHNlXSAtIFNldCB0byBgdHJ1ZWAgaW4gb3JkZXIgdG8gYWx3YXlzIHByZWZlclxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGUgY3VycmVudCBidWlsZCBvdmVyIGFueSBpbnN0YWxsZWQgcGFja2FnZXMgaGF2aW5nXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoZSBzYW1lIGlkZW50aWZpZXJcbiAqL1xuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IEluc3RhbGxPclVwZ3JhZGVSZXN1bHRcbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gd2FzVW5pbnN0YWxsZWQgLSBFcXVhbHMgdG8gYHRydWVgIGlmIHRoZSB0YXJnZXQgYXBwIGhhcyBiZWVuIHVuaW5zdGFsbGVkXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmVmb3JlIGJlaW5nIGluc3RhbGxlZFxuICogQHByb3BlcnR5IHtBUFBfSU5TVEFMTF9TVEFURX0gYXBwU3RhdGUgLSBPbmUgb2YgYGFkYi5BUFBfSU5TVEFMTF9TVEFURWAgc3RhdGVzLCB3aGljaCByZWZsZWN0c1xuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGUgc3RhdGUgb2YgdGhlIGFwcGxpY2F0aW9uIGJlZm9yZSBiZWluZyBpbnN0YWxsZWQuXG4gKi9cblxuLyoqXG4gKiBJbnN0YWxsIHRoZSBwYWNrYWdlIGZyb20gdGhlIGxvY2FsIGZpbGUgc3lzdGVtIG9yIHVwZ3JhZGUgaXQgaWYgYW4gb2xkZXJcbiAqIHZlcnNpb24gb2YgdGhlIHNhbWUgcGFja2FnZSBpcyBhbHJlYWR5IGluc3RhbGxlZC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gYXBwUGF0aCAtIFRoZSBmdWxsIHBhdGggdG8gdGhlIGxvY2FsIHBhY2thZ2UuXG4gKiBAcGFyYW0gez9zdHJpbmd9IHBrZyAtIFRoZSBuYW1lIG9mIHRoZSBpbnN0YWxsZWQgcGFja2FnZS4gVGhlIG1ldGhvZCB3aWxsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgIHBlcmZvcm0gZmFzdGVyIGlmIGl0IGlzIHNldC5cbiAqIEBwYXJhbSB7P0luc3RhbGxPclVwZ3JhZGVPcHRpb25zfSBvcHRpb25zIC0gU2V0IG9mIGluc3RhbGwgb3B0aW9ucy5cbiAqIEB0aHJvd3Mge0Vycm9yfSBJZiBhbiB1bmV4cGVjdGVkIGVycm9yIGhhcHBlbnMgZHVyaW5nIGluc3RhbGwuXG4gKiBAcmV0dXJucyB7SW5zdGFsbE9yVXBncmFkZVJlc3VsdH1cbiAqL1xuYXBrVXRpbHNNZXRob2RzLmluc3RhbGxPclVwZ3JhZGUgPSBhc3luYyBmdW5jdGlvbiBpbnN0YWxsT3JVcGdyYWRlIChhcHBQYXRoLCBwa2cgPSBudWxsLCBvcHRpb25zID0ge30pIHtcbiAgaWYgKCFwa2cpIHtcbiAgICBjb25zdCBhcGtJbmZvID0gYXdhaXQgdGhpcy5nZXRBcGtJbmZvKGFwcFBhdGgpO1xuICAgIHBrZyA9IGFwa0luZm8ubmFtZTtcbiAgfVxuXG4gIGNvbnN0IHtcbiAgICBlbmZvcmNlQ3VycmVudEJ1aWxkLFxuICB9ID0gb3B0aW9ucztcbiAgY29uc3QgYXBwU3RhdGUgPSBhd2FpdCB0aGlzLmdldEFwcGxpY2F0aW9uSW5zdGFsbFN0YXRlKGFwcFBhdGgsIHBrZyk7XG4gIGxldCB3YXNVbmluc3RhbGxlZCA9IGZhbHNlO1xuICBjb25zdCB1bmluc3RhbGxQYWNrYWdlID0gYXN5bmMgKCkgPT4ge1xuICAgIGlmICghYXdhaXQgdGhpcy51bmluc3RhbGxBcGsocGtnKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGAnJHtwa2d9JyBwYWNrYWdlIGNhbm5vdCBiZSB1bmluc3RhbGxlZGApO1xuICAgIH1cbiAgICB3YXNVbmluc3RhbGxlZCA9IHRydWU7XG4gIH07XG4gIHN3aXRjaCAoYXBwU3RhdGUpIHtcbiAgICBjYXNlIHRoaXMuQVBQX0lOU1RBTExfU1RBVEUuTk9UX0lOU1RBTExFRDpcbiAgICAgIGxvZy5kZWJ1ZyhgSW5zdGFsbGluZyAnJHthcHBQYXRofSdgKTtcbiAgICAgIGF3YWl0IHRoaXMuaW5zdGFsbChhcHBQYXRoLCBPYmplY3QuYXNzaWduKHt9LCBvcHRpb25zLCB7cmVwbGFjZTogZmFsc2V9KSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBhcHBTdGF0ZSxcbiAgICAgICAgd2FzVW5pbnN0YWxsZWQsXG4gICAgICB9O1xuICAgIGNhc2UgdGhpcy5BUFBfSU5TVEFMTF9TVEFURS5ORVdFUl9WRVJTSU9OX0lOU1RBTExFRDpcbiAgICAgIGlmIChlbmZvcmNlQ3VycmVudEJ1aWxkKSB7XG4gICAgICAgIGxvZy5pbmZvKGBEb3duZ3JhZGluZyAnJHtwa2d9JyBhcyByZXF1ZXN0ZWRgKTtcbiAgICAgICAgYXdhaXQgdW5pbnN0YWxsUGFja2FnZSgpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGxvZy5kZWJ1ZyhgVGhlcmUgaXMgbm8gbmVlZCB0byBkb3duZ3JhZGUgJyR7cGtnfSdgKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGFwcFN0YXRlLFxuICAgICAgICB3YXNVbmluc3RhbGxlZCxcbiAgICAgIH07XG4gICAgY2FzZSB0aGlzLkFQUF9JTlNUQUxMX1NUQVRFLlNBTUVfVkVSU0lPTl9JTlNUQUxMRUQ6XG4gICAgICBpZiAoZW5mb3JjZUN1cnJlbnRCdWlsZCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGxvZy5kZWJ1ZyhgVGhlcmUgaXMgbm8gbmVlZCB0byBpbnN0YWxsL3VwZ3JhZGUgJyR7YXBwUGF0aH0nYCk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBhcHBTdGF0ZSxcbiAgICAgICAgd2FzVW5pbnN0YWxsZWQsXG4gICAgICB9O1xuICAgIGNhc2UgdGhpcy5BUFBfSU5TVEFMTF9TVEFURS5PTERFUl9WRVJTSU9OX0lOU1RBTExFRDpcbiAgICAgIGxvZy5kZWJ1ZyhgRXhlY3V0aW5nIHVwZ3JhZGUgb2YgJyR7YXBwUGF0aH0nYCk7XG4gICAgICBicmVhaztcbiAgICBkZWZhdWx0OlxuICAgICAgbG9nLmRlYnVnKGBUaGUgY3VycmVudCBpbnN0YWxsIHN0YXRlIG9mICcke2FwcFBhdGh9JyBpcyB1bmtub3duLiBJbnN0YWxsaW5nIGFueXdheWApO1xuICAgICAgYnJlYWs7XG4gIH1cblxuICB0cnkge1xuICAgIGF3YWl0IHRoaXMuaW5zdGFsbChhcHBQYXRoLCBPYmplY3QuYXNzaWduKHt9LCBvcHRpb25zLCB7cmVwbGFjZTogdHJ1ZX0pKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgbG9nLndhcm4oYENhbm5vdCBpbnN0YWxsL3VwZ3JhZGUgJyR7cGtnfScgYmVjYXVzZSBvZiAnJHtlcnIubWVzc2FnZX0nLiBUcnlpbmcgZnVsbCByZWluc3RhbGxgKTtcbiAgICBhd2FpdCB1bmluc3RhbGxQYWNrYWdlKCk7XG4gICAgYXdhaXQgdGhpcy5pbnN0YWxsKGFwcFBhdGgsIE9iamVjdC5hc3NpZ24oe30sIG9wdGlvbnMsIHtyZXBsYWNlOiBmYWxzZX0pKTtcbiAgfVxuICByZXR1cm4ge1xuICAgIGFwcFN0YXRlLFxuICAgIHdhc1VuaW5zdGFsbGVkLFxuICB9O1xufTtcblxuLyoqXG4gKiBFeHRyYWN0IHN0cmluZyByZXNvdXJjZXMgZnJvbSB0aGUgZ2l2ZW4gcGFja2FnZSBvbiBsb2NhbCBmaWxlIHN5c3RlbS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gYXBwUGF0aCAtIFRoZSBmdWxsIHBhdGggdG8gdGhlIC5hcGsocykgcGFja2FnZS5cbiAqIEBwYXJhbSB7P3N0cmluZ30gbGFuZ3VhZ2UgLSBUaGUgbmFtZSBvZiB0aGUgbGFuZ3VhZ2UgdG8gZXh0cmFjdCB0aGUgcmVzb3VyY2VzIGZvci5cbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUaGUgZGVmYXVsdCBsYW5ndWFnZSBpcyB1c2VkIGlmIHRoaXMgZXF1YWxzIHRvIGBudWxsYC9gdW5kZWZpbmVkYFxuICogQHBhcmFtIHtzdHJpbmd9IG91dCAtIFRoZSBuYW1lIG9mIHRoZSBkZXN0aW5hdGlvbiBmb2xkZXIgb24gdGhlIGxvY2FsIGZpbGUgc3lzdGVtIHRvXG4gKiAgICAgICAgICAgICAgICAgICAgICAgc3RvcmUgdGhlIGV4dHJhY3RlZCBmaWxlIHRvLlxuICogQHJldHVybiB7T2JqZWN0fSBBIG1hcHBpbmcgb2JqZWN0LCB3aGVyZSBwcm9wZXJ0aWVzIGFyZTogJ2Fwa1N0cmluZ3MnLCBjb250YWluaW5nXG4gKiAgICAgICAgICAgICAgICAgIHBhcnNlZCByZXNvdXJjZSBmaWxlIHJlcHJlc2VudGVkIGFzIEpTT04gb2JqZWN0LCBhbmQgJ2xvY2FsUGF0aCcsXG4gKiAgICAgICAgICAgICAgICAgIGNvbnRhaW5pbmcgdGhlIHBhdGggdG8gdGhlIGV4dHJhY3RlZCBmaWxlIG9uIHRoZSBsb2NhbCBmaWxlIHN5c3RlbS5cbiAqL1xuYXBrVXRpbHNNZXRob2RzLmV4dHJhY3RTdHJpbmdzRnJvbUFwayA9IGFzeW5jIGZ1bmN0aW9uIGV4dHJhY3RTdHJpbmdzRnJvbUFwayAoYXBwUGF0aCwgbGFuZ3VhZ2UsIG91dCkge1xuICBsb2cuZGVidWcoYEV4dHJhY3Rpbmcgc3RyaW5ncyBmcm9tIGZvciBsYW5ndWFnZTogJHtsYW5ndWFnZSB8fCAnZGVmYXVsdCd9YCk7XG4gIGNvbnN0IG9yaWdpbmFsQXBwUGF0aCA9IGFwcFBhdGg7XG4gIGlmIChhcHBQYXRoLmVuZHNXaXRoKEFQS1NfRVhURU5TSU9OKSkge1xuICAgIGFwcFBhdGggPSBhd2FpdCB0aGlzLmV4dHJhY3RMYW5ndWFnZUFwayhhcHBQYXRoLCBsYW5ndWFnZSk7XG4gIH1cblxuICBsZXQgYXBrU3RyaW5ncyA9IHt9O1xuICBsZXQgY29uZmlnTWFya2VyO1xuICB0cnkge1xuICAgIGF3YWl0IHRoaXMuaW5pdEFhcHQoKTtcblxuICAgIGNvbmZpZ01hcmtlciA9IGF3YWl0IGZvcm1hdENvbmZpZ01hcmtlcihhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB7c3Rkb3V0fSA9IGF3YWl0IGV4ZWModGhpcy5iaW5hcmllcy5hYXB0LCBbXG4gICAgICAgICdkJywgJ2NvbmZpZ3VyYXRpb25zJywgYXBwUGF0aCxcbiAgICAgIF0pO1xuICAgICAgcmV0dXJuIF8udW5pcShzdGRvdXQuc3BsaXQob3MuRU9MKSk7XG4gICAgfSwgbGFuZ3VhZ2UsICcoZGVmYXVsdCknKTtcblxuICAgIGNvbnN0IHtzdGRvdXR9ID0gYXdhaXQgZXhlYyh0aGlzLmJpbmFyaWVzLmFhcHQsIFtcbiAgICAgICdkJywgJy0tdmFsdWVzJywgJ3Jlc291cmNlcycsIGFwcFBhdGgsXG4gICAgXSk7XG4gICAgYXBrU3RyaW5ncyA9IHBhcnNlQWFwdFN0cmluZ3Moc3Rkb3V0LCBjb25maWdNYXJrZXIpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgbG9nLmRlYnVnKCdDYW5ub3QgZXh0cmFjdCByZXNvdXJjZXMgdXNpbmcgYWFwdC4gVHJ5aW5nIGFhcHQyLiAnICtcbiAgICAgIGBPcmlnaW5hbCBlcnJvcjogJHtlLnN0ZGVyciB8fCBlLm1lc3NhZ2V9YCk7XG5cbiAgICBhd2FpdCB0aGlzLmluaXRBYXB0MigpO1xuXG4gICAgY29uZmlnTWFya2VyID0gYXdhaXQgZm9ybWF0Q29uZmlnTWFya2VyKGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHtzdGRvdXR9ID0gYXdhaXQgZXhlYyh0aGlzLmJpbmFyaWVzLmFhcHQyLCBbXG4gICAgICAgICdkJywgJ2NvbmZpZ3VyYXRpb25zJywgYXBwUGF0aCxcbiAgICAgIF0pO1xuICAgICAgcmV0dXJuIF8udW5pcShzdGRvdXQuc3BsaXQob3MuRU9MKSk7XG4gICAgfSwgbGFuZ3VhZ2UsICcnKTtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCB7c3Rkb3V0fSA9IGF3YWl0IGV4ZWModGhpcy5iaW5hcmllcy5hYXB0MiwgW1xuICAgICAgICAnZCcsICdyZXNvdXJjZXMnLCBhcHBQYXRoLFxuICAgICAgXSk7XG4gICAgICBhcGtTdHJpbmdzID0gcGFyc2VBYXB0MlN0cmluZ3Moc3Rkb3V0LCBjb25maWdNYXJrZXIpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQ2Fubm90IGV4dHJhY3QgcmVzb3VyY2VzIGZyb20gJyR7b3JpZ2luYWxBcHBQYXRofScuIGAgK1xuICAgICAgICBgT3JpZ2luYWwgZXJyb3I6ICR7ZS5tZXNzYWdlfWApO1xuICAgIH1cbiAgfVxuXG4gIGlmIChfLmlzRW1wdHkoYXBrU3RyaW5ncykpIHtcbiAgICBsb2cud2FybihgTm8gc3RyaW5ncyBoYXZlIGJlZW4gZm91bmQgaW4gJyR7b3JpZ2luYWxBcHBQYXRofScgcmVzb3VyY2VzIGAgK1xuICAgICAgYGZvciAnJHtjb25maWdNYXJrZXIgfHwgJ2RlZmF1bHQnfScgY29uZmlndXJhdGlvbmApO1xuICB9IGVsc2Uge1xuICAgIGxvZy5pbmZvKGBTdWNjZXNzZnVsbHkgZXh0cmFjdGVkICR7Xy5rZXlzKGFwa1N0cmluZ3MpLmxlbmd0aH0gc3RyaW5ncyBmcm9tIGAgK1xuICAgICAgYCcke29yaWdpbmFsQXBwUGF0aH0nIHJlc291cmNlcyBmb3IgJyR7Y29uZmlnTWFya2VyIHx8ICdkZWZhdWx0J30nIGNvbmZpZ3VyYXRpb25gKTtcbiAgfVxuXG4gIGNvbnN0IGxvY2FsUGF0aCA9IHBhdGgucmVzb2x2ZShvdXQsICdzdHJpbmdzLmpzb24nKTtcbiAgYXdhaXQgbWtkaXJwKG91dCk7XG4gIGF3YWl0IGZzLndyaXRlRmlsZShsb2NhbFBhdGgsIEpTT04uc3RyaW5naWZ5KGFwa1N0cmluZ3MsIG51bGwsIDIpLCAndXRmLTgnKTtcbiAgcmV0dXJuIHthcGtTdHJpbmdzLCBsb2NhbFBhdGh9O1xufTtcblxuLyoqXG4gKiBHZXQgdGhlIGxhbmd1YWdlIG5hbWUgb2YgdGhlIGRldmljZSB1bmRlciB0ZXN0LlxuICpcbiAqIEByZXR1cm4ge3N0cmluZ30gVGhlIG5hbWUgb2YgZGV2aWNlIGxhbmd1YWdlLlxuICovXG5hcGtVdGlsc01ldGhvZHMuZ2V0RGV2aWNlTGFuZ3VhZ2UgPSBhc3luYyBmdW5jdGlvbiBnZXREZXZpY2VMYW5ndWFnZSAoKSB7XG4gIGxldCBsYW5ndWFnZTtcbiAgaWYgKGF3YWl0IHRoaXMuZ2V0QXBpTGV2ZWwoKSA8IDIzKSB7XG4gICAgbGFuZ3VhZ2UgPSBhd2FpdCB0aGlzLmdldERldmljZVN5c0xhbmd1YWdlKCk7XG4gICAgaWYgKCFsYW5ndWFnZSkge1xuICAgICAgbGFuZ3VhZ2UgPSBhd2FpdCB0aGlzLmdldERldmljZVByb2R1Y3RMYW5ndWFnZSgpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBsYW5ndWFnZSA9IChhd2FpdCB0aGlzLmdldERldmljZUxvY2FsZSgpKS5zcGxpdCgnLScpWzBdO1xuICB9XG4gIHJldHVybiBsYW5ndWFnZTtcbn07XG5cbi8qKlxuICogR2V0IHRoZSBjb3VudHJ5IG5hbWUgb2YgdGhlIGRldmljZSB1bmRlciB0ZXN0LlxuICpcbiAqIEByZXR1cm4ge3N0cmluZ30gVGhlIG5hbWUgb2YgZGV2aWNlIGNvdW50cnkuXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5nZXREZXZpY2VDb3VudHJ5ID0gYXN5bmMgZnVuY3Rpb24gZ2V0RGV2aWNlQ291bnRyeSAoKSB7XG4gIC8vIHRoaXMgbWV0aG9kIGlzIG9ubHkgdXNlZCBpbiBBUEkgPCAyM1xuICBsZXQgY291bnRyeSA9IGF3YWl0IHRoaXMuZ2V0RGV2aWNlU3lzQ291bnRyeSgpO1xuICBpZiAoIWNvdW50cnkpIHtcbiAgICBjb3VudHJ5ID0gYXdhaXQgdGhpcy5nZXREZXZpY2VQcm9kdWN0Q291bnRyeSgpO1xuICB9XG4gIHJldHVybiBjb3VudHJ5O1xufTtcblxuLyoqXG4gKiBHZXQgdGhlIGxvY2FsZSBuYW1lIG9mIHRoZSBkZXZpY2UgdW5kZXIgdGVzdC5cbiAqXG4gKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBuYW1lIG9mIGRldmljZSBsb2NhbGUuXG4gKi9cbmFwa1V0aWxzTWV0aG9kcy5nZXREZXZpY2VMb2NhbGUgPSBhc3luYyBmdW5jdGlvbiBnZXREZXZpY2VMb2NhbGUgKCkge1xuICAvLyB0aGlzIG1ldGhvZCBpcyBvbmx5IHVzZWQgaW4gQVBJID49IDIzXG4gIGxldCBsb2NhbGUgPSBhd2FpdCB0aGlzLmdldERldmljZVN5c0xvY2FsZSgpO1xuICBpZiAoIWxvY2FsZSkge1xuICAgIGxvY2FsZSA9IGF3YWl0IHRoaXMuZ2V0RGV2aWNlUHJvZHVjdExvY2FsZSgpO1xuICB9XG4gIHJldHVybiBsb2NhbGU7XG59O1xuXG4vKipcbiAqIFNldCB0aGUgbG9jYWxlIG5hbWUgb2YgdGhlIGRldmljZSB1bmRlciB0ZXN0IGFuZCB0aGUgZm9ybWF0IG9mIHRoZSBsb2NhbGUgaXMgZW4tVVMsIGZvciBleGFtcGxlLlxuICogVGhpcyBtZXRob2QgY2FsbCBzZXREZXZpY2VMYW5ndWFnZUNvdW50cnksIHNvLCBwbGVhc2UgdXNlIHNldERldmljZUxhbmd1YWdlQ291bnRyeSBhcyBwb3NzaWJsZS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gbG9jYWxlIC0gTmFtZXMgb2YgdGhlIGRldmljZSBsYW5ndWFnZSBhbmQgdGhlIGNvdW50cnkgY29ubmVjdGVkIHdpdGggYC1gLiBlLmcuIGVuLVVTLlxuICovXG5hcGtVdGlsc01ldGhvZHMuc2V0RGV2aWNlTG9jYWxlID0gYXN5bmMgZnVuY3Rpb24gc2V0RGV2aWNlTG9jYWxlIChsb2NhbGUpIHtcbiAgY29uc3QgdmFsaWRhdGVMb2NhbGUgPSBuZXcgUmVnRXhwKC9bYS16QS1aXSstW2EtekEtWjAtOV0rLyk7XG4gIGlmICghdmFsaWRhdGVMb2NhbGUudGVzdChsb2NhbGUpKSB7XG4gICAgbG9nLndhcm4oYHNldERldmljZUxvY2FsZSByZXF1aXJlcyB0aGUgZm9sbG93aW5nIGZvcm1hdDogZW4tVVMgb3IgamEtSlBgKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBsZXQgc3BsaXRfbG9jYWxlID0gbG9jYWxlLnNwbGl0KCctJyk7XG4gIGF3YWl0IHRoaXMuc2V0RGV2aWNlTGFuZ3VhZ2VDb3VudHJ5KHNwbGl0X2xvY2FsZVswXSwgc3BsaXRfbG9jYWxlWzFdKTtcbn07XG5cbi8qKlxuICogTWFrZSBzdXJlIGN1cnJlbnQgZGV2aWNlIGxvY2FsZSBpcyBleHBlY3RlZCBvciBub3QuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGxhbmd1YWdlIC0gTGFuZ3VhZ2UuIFRoZSBsYW5ndWFnZSBmaWVsZCBpcyBjYXNlIGluc2Vuc2l0aXZlLCBidXQgTG9jYWxlIGFsd2F5cyBjYW5vbmljYWxpemVzIHRvIGxvd2VyIGNhc2UuXG4gKiBAcGFyYW0ge3N0cmluZ30gY291bnRyeSAtIENvdW50cnkuIFRoZSBsYW5ndWFnZSBmaWVsZCBpcyBjYXNlIGluc2Vuc2l0aXZlLCBidXQgTG9jYWxlIGFsd2F5cyBjYW5vbmljYWxpemVzIHRvIGxvd2VyIGNhc2UuXG4gKiBAcGFyYW0gez9zdHJpbmd9IHNjcmlwdCAtIFNjcmlwdC4gVGhlIHNjcmlwdCBmaWVsZCBpcyBjYXNlIGluc2Vuc2l0aXZlIGJ1dCBMb2NhbGUgYWx3YXlzIGNhbm9uaWNhbGl6ZXMgdG8gdGl0bGUgY2FzZS5cbiAqXG4gKiBAcmV0dXJuIHtib29sZWFufSBJZiBjdXJyZW50IGxvY2FsZSBpcyBsYW5ndWFnZSBhbmQgY291bnRyeSBhcyBhcmd1bWVudHMsIHJldHVybiB0cnVlLlxuICovXG5hcGtVdGlsc01ldGhvZHMuZW5zdXJlQ3VycmVudExvY2FsZSA9IGFzeW5jIGZ1bmN0aW9uIGVuc3VyZUN1cnJlbnRMb2NhbGUgKGxhbmd1YWdlLCBjb3VudHJ5LCBzY3JpcHQgPSBudWxsKSB7XG4gIGNvbnN0IGhhc0xhbmd1YWdlID0gXy5pc1N0cmluZyhsYW5ndWFnZSk7XG4gIGNvbnN0IGhhc0NvdW50cnkgPSBfLmlzU3RyaW5nKGNvdW50cnkpO1xuXG4gIGlmICghaGFzTGFuZ3VhZ2UgJiYgIWhhc0NvdW50cnkpIHtcbiAgICBsb2cud2FybignZW5zdXJlQ3VycmVudExvY2FsZSByZXF1aXJlcyBsYW5ndWFnZSBvciBjb3VudHJ5Jyk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgLy8gZ2V0IGxvd2VyIGNhc2UgdmVyc2lvbnMgb2YgdGhlIHN0cmluZ3NcbiAgbGFuZ3VhZ2UgPSAobGFuZ3VhZ2UgfHwgJycpLnRvTG93ZXJDYXNlKCk7XG4gIGNvdW50cnkgPSAoY291bnRyeSB8fCAnJykudG9Mb3dlckNhc2UoKTtcblxuICBjb25zdCBhcGlMZXZlbCA9IGF3YWl0IHRoaXMuZ2V0QXBpTGV2ZWwoKTtcblxuICByZXR1cm4gYXdhaXQgcmV0cnlJbnRlcnZhbCg1LCAxMDAwLCBhc3luYyAoKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGlmIChhcGlMZXZlbCA8IDIzKSB7XG4gICAgICAgIGxldCBjdXJMYW5ndWFnZSwgY3VyQ291bnRyeTtcbiAgICAgICAgaWYgKGhhc0xhbmd1YWdlKSB7XG4gICAgICAgICAgY3VyTGFuZ3VhZ2UgPSAoYXdhaXQgdGhpcy5nZXREZXZpY2VMYW5ndWFnZSgpKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgIGlmICghaGFzQ291bnRyeSAmJiBsYW5ndWFnZSA9PT0gY3VyTGFuZ3VhZ2UpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoaGFzQ291bnRyeSkge1xuICAgICAgICAgIGN1ckNvdW50cnkgPSAoYXdhaXQgdGhpcy5nZXREZXZpY2VDb3VudHJ5KCkpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgaWYgKCFoYXNMYW5ndWFnZSAmJiBjb3VudHJ5ID09PSBjdXJDb3VudHJ5KSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxhbmd1YWdlID09PSBjdXJMYW5ndWFnZSAmJiBjb3VudHJ5ID09PSBjdXJDb3VudHJ5KSB7XG4gICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IGN1ckxvY2FsZSA9IChhd2FpdCB0aGlzLmdldERldmljZUxvY2FsZSgpKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAvLyB6aC1oYW5zLWNuIDogemgtY25cbiAgICAgICAgY29uc3QgbG9jYWxlQ29kZSA9IHNjcmlwdCA/IGAke2xhbmd1YWdlfS0ke3NjcmlwdC50b0xvd2VyQ2FzZSgpfS0ke2NvdW50cnl9YCA6IGAke2xhbmd1YWdlfS0ke2NvdW50cnl9YDtcblxuICAgICAgICBpZiAobG9jYWxlQ29kZSA9PT0gY3VyTG9jYWxlKSB7XG4gICAgICAgICAgbG9nLmRlYnVnKGBSZXF1ZXN0ZWQgbG9jYWxlIGlzIGVxdWFsIHRvIGN1cnJlbnQgbG9jYWxlOiAnJHtjdXJMb2NhbGV9J2ApO1xuICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAvLyBpZiB0aGVyZSBoYXMgYmVlbiBhbiBlcnJvciwgcmVzdGFydCBhZGIgYW5kIHJldHJ5XG4gICAgICBsb2cuZXJyb3IoYFVuYWJsZSB0byBjaGVjayBkZXZpY2UgbG9jYWxpemF0aW9uOiAke2Vyci5tZXNzYWdlfWApO1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgdGhpcy5yZWNvbm5lY3QoKTtcbiAgICAgIH0gY2F0Y2ggKGlnbikge1xuICAgICAgICBhd2FpdCB0aGlzLnJlc3RhcnRBZGIoKTtcbiAgICAgIH1cbiAgICAgIHRocm93IGVycjtcbiAgICB9XG4gIH0pO1xufTtcblxuLyoqXG4gKiBTZXQgdGhlIGxvY2FsZSBuYW1lIG9mIHRoZSBkZXZpY2UgdW5kZXIgdGVzdC5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gbGFuZ3VhZ2UgLSBMYW5ndWFnZS4gVGhlIGxhbmd1YWdlIGZpZWxkIGlzIGNhc2UgaW5zZW5zaXRpdmUsIGJ1dCBMb2NhbGUgYWx3YXlzIGNhbm9uaWNhbGl6ZXMgdG8gbG93ZXIgY2FzZS5cbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDogW2EtekEtWl17Miw4fS4gZS5nLiBlbiwgamEgOiBodHRwczovL2RldmVsb3Blci5hbmRyb2lkLmNvbS9yZWZlcmVuY2UvamF2YS91dGlsL0xvY2FsZS5odG1sXG4gKiBAcGFyYW0ge3N0cmluZ30gY291bnRyeSAtIENvdW50cnkuIFRoZSBjb3VudHJ5IChyZWdpb24pIGZpZWxkIGlzIGNhc2UgaW5zZW5zaXRpdmUsIGJ1dCBMb2NhbGUgYWx3YXlzIGNhbm9uaWNhbGl6ZXMgdG8gdXBwZXIgY2FzZS5cbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDogW2EtekEtWl17Mn0gfCBbMC05XXszfS4gZS5nLiBVUywgSlAgOiBodHRwczovL2RldmVsb3Blci5hbmRyb2lkLmNvbS9yZWZlcmVuY2UvamF2YS91dGlsL0xvY2FsZS5odG1sXG4gKiBAcGFyYW0gez9zdHJpbmd9IHNjcmlwdCAtIFNjcmlwdC4gVGhlIHNjcmlwdCBmaWVsZCBpcyBjYXNlIGluc2Vuc2l0aXZlIGJ1dCBMb2NhbGUgYWx3YXlzIGNhbm9uaWNhbGl6ZXMgdG8gdGl0bGUgY2FzZS5cbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDogW2EtekEtWl17NH0uIGUuZy4gSGFucyBpbiB6aC1IYW5zLUNOIDogaHR0cHM6Ly9kZXZlbG9wZXIuYW5kcm9pZC5jb20vcmVmZXJlbmNlL2phdmEvdXRpbC9Mb2NhbGUuaHRtbFxuICovXG5hcGtVdGlsc01ldGhvZHMuc2V0RGV2aWNlTGFuZ3VhZ2VDb3VudHJ5ID0gYXN5bmMgZnVuY3Rpb24gc2V0RGV2aWNlTGFuZ3VhZ2VDb3VudHJ5IChsYW5ndWFnZSwgY291bnRyeSwgc2NyaXB0ID0gbnVsbCkge1xuICBsZXQgaGFzTGFuZ3VhZ2UgPSBsYW5ndWFnZSAmJiBfLmlzU3RyaW5nKGxhbmd1YWdlKTtcbiAgbGV0IGhhc0NvdW50cnkgPSBjb3VudHJ5ICYmIF8uaXNTdHJpbmcoY291bnRyeSk7XG4gIGlmICghaGFzTGFuZ3VhZ2UgfHwgIWhhc0NvdW50cnkpIHtcbiAgICBsb2cud2Fybihgc2V0RGV2aWNlTGFuZ3VhZ2VDb3VudHJ5IHJlcXVpcmVzIGxhbmd1YWdlIGFuZCBjb3VudHJ5IGF0IGxlYXN0YCk7XG4gICAgbG9nLndhcm4oYEdvdCBsYW5ndWFnZTogJyR7bGFuZ3VhZ2V9JyBhbmQgY291bnRyeTogJyR7Y291bnRyeX0nYCk7XG4gICAgcmV0dXJuO1xuICB9XG4gIGxldCBhcGlMZXZlbCA9IGF3YWl0IHRoaXMuZ2V0QXBpTGV2ZWwoKTtcblxuICBsYW5ndWFnZSA9IChsYW5ndWFnZSB8fCAnJykudG9Mb3dlckNhc2UoKTtcbiAgY291bnRyeSA9IChjb3VudHJ5IHx8ICcnKS50b1VwcGVyQ2FzZSgpO1xuXG4gIGlmIChhcGlMZXZlbCA8IDIzKSB7XG4gICAgbGV0IGN1ckxhbmd1YWdlID0gKGF3YWl0IHRoaXMuZ2V0RGV2aWNlTGFuZ3VhZ2UoKSkudG9Mb3dlckNhc2UoKTtcbiAgICBsZXQgY3VyQ291bnRyeSA9IChhd2FpdCB0aGlzLmdldERldmljZUNvdW50cnkoKSkudG9VcHBlckNhc2UoKTtcblxuICAgIGlmIChsYW5ndWFnZSAhPT0gY3VyTGFuZ3VhZ2UgfHwgY291bnRyeSAhPT0gY3VyQ291bnRyeSkge1xuICAgICAgYXdhaXQgdGhpcy5zZXREZXZpY2VTeXNMb2NhbGVWaWFTZXR0aW5nQXBwKGxhbmd1YWdlLCBjb3VudHJ5KTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgbGV0IGN1ckxvY2FsZSA9IGF3YWl0IHRoaXMuZ2V0RGV2aWNlTG9jYWxlKCk7XG5cbiAgICAvLyB6aC1IYW5zLUNOIDogemgtQ05cbiAgICBjb25zdCBsb2NhbGVDb2RlID0gc2NyaXB0ID8gYCR7bGFuZ3VhZ2V9LSR7c2NyaXB0fS0ke2NvdW50cnl9YCA6IGAke2xhbmd1YWdlfS0ke2NvdW50cnl9YDtcbiAgICBsb2cuZGVidWcoYEN1cnJlbnQgbG9jYWxlOiAnJHtjdXJMb2NhbGV9JzsgcmVxdWVzdGVkIGxvY2FsZTogJyR7bG9jYWxlQ29kZX0nYCk7XG4gICAgaWYgKGxvY2FsZUNvZGUudG9Mb3dlckNhc2UoKSAhPT0gY3VyTG9jYWxlLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgIGF3YWl0IHRoaXMuc2V0RGV2aWNlU3lzTG9jYWxlVmlhU2V0dGluZ0FwcChsYW5ndWFnZSwgY291bnRyeSwgc2NyaXB0KTtcbiAgICB9XG4gIH1cbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gQXBwSW5mb1xuICogQHByb3BlcnR5IHtzdHJpbmd9IG5hbWUgLSBQYWNrYWdlIG5hbWUsIGZvciBleGFtcGxlICdjb20uYWNtZS5hcHAnLlxuICogQHByb3BlcnR5IHtudW1iZXJ9IHZlcnNpb25Db2RlIC0gVmVyc2lvbiBjb2RlLlxuICogQHByb3BlcnR5IHtzdHJpbmd9IHZlcnNpb25OYW1lIC0gVmVyc2lvbiBuYW1lLCBmb3IgZXhhbXBsZSAnMS4wJy5cbiAqL1xuXG4vKipcbiAqIEdldCB0aGUgcGFja2FnZSBpbmZvIGZyb20gbG9jYWwgYXBrIGZpbGUuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGFwcFBhdGggLSBUaGUgZnVsbCBwYXRoIHRvIGV4aXN0aW5nIC5hcGsocykgcGFja2FnZSBvbiB0aGUgbG9jYWxcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZSBzeXN0ZW0uXG4gKiBAcmV0dXJuIHs/QXBwSW5mb30gVGhlIHBhcnNlZCBhcHBsaWNhdGlvbiBpbmZvcm1hdGlvbi5cbiAqL1xuYXBrVXRpbHNNZXRob2RzLmdldEFwa0luZm8gPSBhc3luYyBmdW5jdGlvbiBnZXRBcGtJbmZvIChhcHBQYXRoKSB7XG4gIGlmICghYXdhaXQgZnMuZXhpc3RzKGFwcFBhdGgpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgZmlsZSBhdCBwYXRoICR7YXBwUGF0aH0gZG9lcyBub3QgZXhpc3Qgb3IgaXMgbm90IGFjY2Vzc2libGVgKTtcbiAgfVxuXG4gIGlmIChhcHBQYXRoLmVuZHNXaXRoKEFQS1NfRVhURU5TSU9OKSkge1xuICAgIGFwcFBhdGggPSBhd2FpdCB0aGlzLmV4dHJhY3RCYXNlQXBrKGFwcFBhdGgpO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBhcGtSZWFkZXIgPSBhd2FpdCBBcGtSZWFkZXIub3BlbihhcHBQYXRoKTtcbiAgICBjb25zdCBtYW5pZmVzdCA9IGF3YWl0IGFwa1JlYWRlci5yZWFkTWFuaWZlc3QoKTtcbiAgICBjb25zdCB7cGtnLCB2ZXJzaW9uTmFtZSwgdmVyc2lvbkNvZGV9ID0gcGFyc2VNYW5pZmVzdChtYW5pZmVzdCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHBrZyxcbiAgICAgIHZlcnNpb25Db2RlLFxuICAgICAgdmVyc2lvbk5hbWUsXG4gICAgfTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIGxvZy53YXJuKGBFcnJvciAnJHtlLm1lc3NhZ2V9JyB3aGlsZSBnZXR0aW5nIGJhZGdpbmcgaW5mb2ApO1xuICB9XG4gIHJldHVybiB7fTtcbn07XG5cbi8qKlxuICogR2V0IHRoZSBwYWNrYWdlIGluZm8gZnJvbSB0aGUgaW5zdGFsbGVkIGFwcGxpY2F0aW9uLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBwa2cgLSBUaGUgbmFtZSBvZiB0aGUgaW5zdGFsbGVkIHBhY2thZ2UuXG4gKiBAcmV0dXJuIHs/QXBwSW5mb30gVGhlIHBhcnNlZCBhcHBsaWNhdGlvbiBpbmZvcm1hdGlvbi5cbiAqL1xuYXBrVXRpbHNNZXRob2RzLmdldFBhY2thZ2VJbmZvID0gYXN5bmMgZnVuY3Rpb24gZ2V0UGFja2FnZUluZm8gKHBrZykge1xuICBsb2cuZGVidWcoYEdldHRpbmcgcGFja2FnZSBpbmZvIGZvciAnJHtwa2d9J2ApO1xuICBsZXQgcmVzdWx0ID0ge25hbWU6IHBrZ307XG4gIHRyeSB7XG4gICAgY29uc3Qgc3Rkb3V0ID0gYXdhaXQgdGhpcy5zaGVsbChbJ2R1bXBzeXMnLCAncGFja2FnZScsIHBrZ10pO1xuICAgIGNvbnN0IHZlcnNpb25OYW1lTWF0Y2ggPSBuZXcgUmVnRXhwKC92ZXJzaW9uTmFtZT0oW1xcZCsuXSspLykuZXhlYyhzdGRvdXQpO1xuICAgIGlmICh2ZXJzaW9uTmFtZU1hdGNoKSB7XG4gICAgICByZXN1bHQudmVyc2lvbk5hbWUgPSB2ZXJzaW9uTmFtZU1hdGNoWzFdO1xuICAgIH1cbiAgICBjb25zdCB2ZXJzaW9uQ29kZU1hdGNoID0gbmV3IFJlZ0V4cCgvdmVyc2lvbkNvZGU9KFxcZCspLykuZXhlYyhzdGRvdXQpO1xuICAgIGlmICh2ZXJzaW9uQ29kZU1hdGNoKSB7XG4gICAgICByZXN1bHQudmVyc2lvbkNvZGUgPSBwYXJzZUludCh2ZXJzaW9uQ29kZU1hdGNoWzFdLCAxMCk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGxvZy53YXJuKGBFcnJvciAnJHtlcnIubWVzc2FnZX0nIHdoaWxlIGR1bXBpbmcgcGFja2FnZSBpbmZvYCk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbi8qKlxuICogRmV0Y2hlcyBiYXNlLmFwayBvZiB0aGUgZ2l2ZW4gcGFja2FnZSB0byB0aGUgbG9jYWwgZmlsZSBzeXN0ZW1cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gcGtnIFRoZSBwYWNrYWdlIGlkZW50aWZpZXIgKG11c3QgYmUgYWxyZWFkeSBpbnN0YWxsZWQgb24gdGhlIGRldmljZSlcbiAqIEBwYXJhbSB7c3RyaW5nfSB0bXBEaXIgVGhlIGRlc3RpbmF0aW9uIGZvbGRlciBwYXRoXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBGdWxsIHBhdGggdG8gdGhlIGRvd25sb2FkZWQgZmlsZVxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZXJlIHdhcyBhbiBlcnJvciB3aGlsZSBmZXRjaGluZyB0aGUgLmFwa1xuICovXG5hcGtVdGlsc01ldGhvZHMucHVsbEFwayA9IGFzeW5jIGZ1bmN0aW9uIHB1bGxBcGsgKHBrZywgdG1wRGlyKSB7XG4gIGNvbnN0IHN0ZG91dCA9IF8udHJpbShhd2FpdCB0aGlzLnNoZWxsKFsncG0nLCAncGF0aCcsIHBrZ10pKTtcbiAgY29uc3QgcGFja2FnZU1hcmtlciA9ICdwYWNrYWdlOic7XG4gIGlmICghXy5zdGFydHNXaXRoKHN0ZG91dCwgcGFja2FnZU1hcmtlcikpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYENhbm5vdCBwdWxsIHRoZSAuYXBrIHBhY2thZ2UgZm9yICcke3BrZ30nLiBPcmlnaW5hbCBlcnJvcjogJHtzdGRvdXR9YCk7XG4gIH1cblxuICBjb25zdCByZW1vdGVQYXRoID0gc3Rkb3V0LnJlcGxhY2UocGFja2FnZU1hcmtlciwgJycpO1xuICBjb25zdCB0bXBBcHAgPSBwYXRoLnJlc29sdmUodG1wRGlyLCBgJHtwa2d9LmFwa2ApO1xuICBhd2FpdCB0aGlzLnB1bGwocmVtb3RlUGF0aCwgdG1wQXBwKTtcbiAgbG9nLmRlYnVnKGBQdWxsZWQgYXBwIGZvciBwYWNrYWdlICcke3BrZ30nIHRvICcke3RtcEFwcH0nYCk7XG4gIHJldHVybiB0bXBBcHA7XG59O1xuXG5leHBvcnQgeyBSRU1PVEVfQ0FDSEVfUk9PVCB9O1xuZXhwb3J0IGRlZmF1bHQgYXBrVXRpbHNNZXRob2RzO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBO0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQSxNQUFNQSxlQUFlLEdBQUcsQ0FBQyxDQUFDO0FBRTFCQSxlQUFlLENBQUNDLGlCQUFpQixHQUFHO0VBQ2xDQyxPQUFPLEVBQUUsU0FBUztFQUNsQkMsYUFBYSxFQUFFLGNBQWM7RUFDN0JDLHVCQUF1QixFQUFFLHVCQUF1QjtFQUNoREMsc0JBQXNCLEVBQUUsc0JBQXNCO0VBQzlDQyx1QkFBdUIsRUFBRTtBQUMzQixDQUFDO0FBQ0QsTUFBTUMsaUJBQWlCLEdBQUcsOEJBQThCOztBQUFDO0FBVXpEUCxlQUFlLENBQUNRLGNBQWMsR0FBRyxlQUFlQSxjQUFjLENBQUVDLEdBQUcsRUFBRTtFQUNuRUMsZUFBRyxDQUFDQyxLQUFLLENBQUUsOEJBQTZCRixHQUFJLEVBQUMsQ0FBQztFQUM5QyxNQUFNRyxnQkFBZ0IsR0FBRyxJQUFJQyxNQUFNLENBQUUsc0JBQXFCQyxlQUFDLENBQUNDLFlBQVksQ0FBQ04sR0FBRyxDQUFF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