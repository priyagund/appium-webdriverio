{"version":3,"file":"rotating-log.js","names":["MAX_LOG_ENTRIES_COUNT","RotatingLog","constructor","showLogs","label","log","logger","getLogger","logs","logIdxSinceLastRequest","isCapturing","startCapture","stopCapture","addLogLine","getLogs","length","result","slice","getAllLogs","_","clone","_logs"],"sources":["../../../lib/device-log/rotating-log.js"],"sourcesContent":["import _ from 'lodash';\nimport { logger } from 'appium/support';\n\n\nconst MAX_LOG_ENTRIES_COUNT = 10000;\n\nclass RotatingLog {\n  constructor (showLogs = false, label = 'Log Label') {\n    this.log = logger.getLogger(label);\n\n    this.showLogs = showLogs;\n    this.logs = [];\n    this.logIdxSinceLastRequest = 0;\n\n    this.isCapturing = false;\n  }\n\n  async startCapture () { // eslint-disable-line require-await\n    this.isCapturing = true;\n  }\n\n  async stopCapture () { // eslint-disable-line require-await\n    this.isCapturing = false;\n  }\n\n  /*\n   * @override\n   */\n  addLogLine () {\n  }\n\n  async getLogs () { // eslint-disable-line require-await\n    if (this.logs.length && this.logIdxSinceLastRequest < this.logs.length) {\n      let result = this.logs;\n      if (this.logIdxSinceLastRequest > 0) {\n        result = result.slice(this.logIdxSinceLastRequest);\n      }\n      this.logIdxSinceLastRequest = this.logs.length;\n      return result;\n    }\n    return [];\n  }\n\n  async getAllLogs () { // eslint-disable-line require-await\n    return _.clone(this.logs);\n  }\n\n  get logs () {\n    if (!this._logs) {\n      this.logs = [];\n    }\n    return this._logs;\n  }\n\n  set logs (logs) {\n    this._logs = logs;\n  }\n}\n\nexport { RotatingLog, MAX_LOG_ENTRIES_COUNT };\nexport default RotatingLog;\n"],"mappings":";;;;;;;;;;;AAAA;;AACA;;AAGA,MAAMA,qBAAqB,GAAG,KAA9B;;;AAEA,MAAMC,WAAN,CAAkB;EAChBC,WAAW,CAAEC,QAAQ,GAAG,KAAb,EAAoBC,KAAK,GAAG,WAA5B,EAAyC;IAClD,KAAKC,GAAL,GAAWC,eAAA,CAAOC,SAAP,CAAiBH,KAAjB,CAAX;IAEA,KAAKD,QAAL,GAAgBA,QAAhB;IACA,KAAKK,IAAL,GAAY,EAAZ;IACA,KAAKC,sBAAL,GAA8B,CAA9B;IAEA,KAAKC,WAAL,GAAmB,KAAnB;EACD;;EAEiB,MAAZC,YAAY,GAAI;IACpB,KAAKD,WAAL,GAAmB,IAAnB;EACD;;EAEgB,MAAXE,WAAW,GAAI;IACnB,KAAKF,WAAL,GAAmB,KAAnB;EACD;;EAKDG,UAAU,GAAI,CACb;;EAEY,MAAPC,OAAO,GAAI;IACf,IAAI,KAAKN,IAAL,CAAUO,MAAV,IAAoB,KAAKN,sBAAL,GAA8B,KAAKD,IAAL,CAAUO,MAAhE,EAAwE;MACtE,IAAIC,MAAM,GAAG,KAAKR,IAAlB;;MACA,IAAI,KAAKC,sBAAL,GAA8B,CAAlC,EAAqC;QACnCO,MAAM,GAAGA,MAAM,CAACC,KAAP,CAAa,KAAKR,sBAAlB,CAAT;MACD;;MACD,KAAKA,sBAAL,GAA8B,KAAKD,IAAL,CAAUO,MAAxC;MACA,OAAOC,MAAP;IACD;;IACD,OAAO,EAAP;EACD;;EAEe,MAAVE,UAAU,GAAI;IAClB,OAAOC,eAAA,CAAEC,KAAF,CAAQ,KAAKZ,IAAb,CAAP;EACD;;EAEO,IAAJA,IAAI,GAAI;IACV,IAAI,CAAC,KAAKa,KAAV,EAAiB;MACf,KAAKb,IAAL,GAAY,EAAZ;IACD;;IACD,OAAO,KAAKa,KAAZ;EACD;;EAEO,IAAJb,IAAI,CAAEA,IAAF,EAAQ;IACd,KAAKa,KAAL,GAAab,IAAb;EACD;;AAlDe;;;eAsDHP,W"}