"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.IOSCrashLog = void 0;

require("source-map-support/register");

var _support = require("appium/support");

var _bluebird = _interopRequireDefault(require("bluebird"));

var _logger = _interopRequireDefault(require("../logger"));

var _appiumIosDevice = require("appium-ios-device");

var _path = _interopRequireDefault(require("path"));

var _lodash = _interopRequireDefault(require("lodash"));

var _pyIosDeviceClient = _interopRequireDefault(require("../py-ios-device-client"));

const REAL_DEVICE_MAGIC = '3620bbb0-fb9f-4b62-a668-896f2edc4d88';
const MAGIC_SEP = '/';

class IOSCrashLog {
  constructor(opts = {}) {
    this.udid = opts.udid;
    this.pyideviceClient = this.udid ? new _pyIosDeviceClient.default(this.udid) : null;
    const logDir = opts.udid ? _path.default.resolve(process.env.HOME, 'Library', 'Logs', 'CrashReporter', 'MobileDevice') : _path.default.resolve(process.env.HOME, 'Library', 'Logs', 'DiagnosticReports');
    this.logDir = logDir || _path.default.resolve(process.env.HOME || '/', 'Library', 'Logs', 'DiagnosticReports');
    this.prevLogs = [];
    this.logsSinceLastRequest = [];
    this.phoneName = null;
    this.sim = opts.sim;
  }

  async _gatherFromRealDevice() {
    if (await this.pyideviceClient.assertExists(false)) {
      return (await this.pyideviceClient.listCrashes()).map(x => `${REAL_DEVICE_MAGIC}${MAGIC_SEP}${x}`);
    }

    let crashLogsRoot = this.logDir;

    if (this.udid) {
      this.phoneName = this.phoneName || (await _appiumIosDevice.utilities.getDeviceName(this.udid));
      crashLogsRoot = _path.default.resolve(crashLogsRoot, this.phoneName);
    }

    if (!(await _support.fs.exists(crashLogsRoot))) {
      _logger.default.debug(`Crash reports root '${crashLogsRoot}' does not exist. Got nothing to gather.`);

      return [];
    }

    const foundFiles = await _support.fs.glob(`${crashLogsRoot}/**/*.crash`, {
      strict: false
    });
    return foundFiles;
  }

  async _gatherFromSimulator() {
    if (!(await _support.fs.exists(this.logDir))) {
      _logger.default.debug(`Crash reports root '${this.logDir}' does not exist. Got nothing to gather.`);

      return [];
    }

    const foundFiles = await _support.fs.glob(`${this.logDir}/**/*.+(crash|ips)`, {
      strict: false
    });
    return await _bluebird.default.filter(foundFiles, async x => {
      try {
        const content = await _support.fs.readFile(x, 'utf8');
        return content.toUpperCase().includes(this.sim.udid.toUpperCase());
      } catch (err) {
        return false;
      }
    });
  }

  async getCrashes() {
    return this.udid ? await this._gatherFromRealDevice() : await this._gatherFromSimulator();
  }

  async startCapture() {
    this.prevLogs = await this.getCrashes();
  }

  async stopCapture() {}

  async getLogs() {
    let crashFiles = await this.getCrashes();

    let diff = _lodash.default.difference(crashFiles, this.prevLogs, this.logsSinceLastRequest);

    this.logsSinceLastRequest = _lodash.default.union(this.logsSinceLastRequest, diff);
    return await this.filesToJSON(diff);
  }

  async getAllLogs() {
    let crashFiles = await this.getCrashes();

    let logFiles = _lodash.default.difference(crashFiles, this.prevLogs);

    return await this.filesToJSON(logFiles);
  }

  async filesToJSON(paths) {
    const tmpRoot = await _support.tempDir.openDir();

    try {
      return (await _bluebird.default.map(paths, async fullPath => {
        if (_lodash.default.includes(fullPath, REAL_DEVICE_MAGIC)) {
          const fileName = _lodash.default.last(fullPath.split(MAGIC_SEP));

          try {
            await this.pyideviceClient.exportCrash(fileName, tmpRoot);
          } catch (e) {
            _logger.default.warn(`Cannot export the crash report '${fileName}'. Skipping it. ` + `Original error: ${e.message}`);

            return;
          }

          fullPath = _path.default.join(tmpRoot, fileName);
        }

        const stat = await _support.fs.stat(fullPath);
        return {
          timestamp: stat.ctime.getTime(),
          level: 'ALL',
          message: await _support.fs.readFile(fullPath, 'utf8')
        };
      })).filter(Boolean);
    } finally {
      await _support.fs.rimraf(tmpRoot);
    }
  }

}

exports.IOSCrashLog = IOSCrashLog;
var _default = IOSCrashLog;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJSRUFMX0RFVklDRV9NQUdJQyIsIk1BR0lDX1NFUCIsIklPU0NyYXNoTG9nIiwiY29uc3RydWN0b3IiLCJvcHRzIiwidWRpZCIsInB5aWRldmljZUNsaWVudCIsIlB5aWRldmljZSIsImxvZ0RpciIsInBhdGgiLCJyZXNvbHZlIiwicHJvY2VzcyIsImVudiIsIkhPTUUiLCJwcmV2TG9ncyIsImxvZ3NTaW5jZUxhc3RSZXF1ZXN0IiwicGhvbmVOYW1lIiwic2ltIiwiX2dhdGhlckZyb21SZWFsRGV2aWNlIiwiYXNzZXJ0RXhpc3RzIiwibGlzdENyYXNoZXMiLCJtYXAiLCJ4IiwiY3Jhc2hMb2dzUm9vdCIsInV0aWxpdGllcyIsImdldERldmljZU5hbWUiLCJmcyIsImV4aXN0cyIsImxvZyIsImRlYnVnIiwiZm91bmRGaWxlcyIsImdsb2IiLCJzdHJpY3QiLCJfZ2F0aGVyRnJvbVNpbXVsYXRvciIsIkIiLCJmaWx0ZXIiLCJjb250ZW50IiwicmVhZEZpbGUiLCJ0b1VwcGVyQ2FzZSIsImluY2x1ZGVzIiwiZXJyIiwiZ2V0Q3Jhc2hlcyIsInN0YXJ0Q2FwdHVyZSIsInN0b3BDYXB0dXJlIiwiZ2V0TG9ncyIsImNyYXNoRmlsZXMiLCJkaWZmIiwiXyIsImRpZmZlcmVuY2UiLCJ1bmlvbiIsImZpbGVzVG9KU09OIiwiZ2V0QWxsTG9ncyIsImxvZ0ZpbGVzIiwicGF0aHMiLCJ0bXBSb290IiwidGVtcERpciIsIm9wZW5EaXIiLCJmdWxsUGF0aCIsImZpbGVOYW1lIiwibGFzdCIsInNwbGl0IiwiZXhwb3J0Q3Jhc2giLCJlIiwid2FybiIsIm1lc3NhZ2UiLCJqb2luIiwic3RhdCIsInRpbWVzdGFtcCIsImN0aW1lIiwiZ2V0VGltZSIsImxldmVsIiwiQm9vbGVhbiIsInJpbXJhZiJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uL2xpYi9kZXZpY2UtbG9nL2lvcy1jcmFzaC1sb2cuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZnMsIHRlbXBEaXIgfSBmcm9tICdhcHBpdW0vc3VwcG9ydCc7XG5pbXBvcnQgQiBmcm9tICdibHVlYmlyZCc7XG5pbXBvcnQgbG9nIGZyb20gJy4uL2xvZ2dlcic7XG5pbXBvcnQgeyB1dGlsaXRpZXMgfSBmcm9tICdhcHBpdW0taW9zLWRldmljZSc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgUHlpZGV2aWNlIGZyb20gJy4uL3B5LWlvcy1kZXZpY2UtY2xpZW50JztcblxuY29uc3QgUkVBTF9ERVZJQ0VfTUFHSUMgPSAnMzYyMGJiYjAtZmI5Zi00YjYyLWE2NjgtODk2ZjJlZGM0ZDg4JztcbmNvbnN0IE1BR0lDX1NFUCA9ICcvJztcblxuXG5jbGFzcyBJT1NDcmFzaExvZyB7XG4gIGNvbnN0cnVjdG9yIChvcHRzID0ge30pIHtcbiAgICB0aGlzLnVkaWQgPSBvcHRzLnVkaWQ7XG4gICAgdGhpcy5weWlkZXZpY2VDbGllbnQgPSB0aGlzLnVkaWQgPyBuZXcgUHlpZGV2aWNlKHRoaXMudWRpZCkgOiBudWxsO1xuICAgIGNvbnN0IGxvZ0RpciA9IG9wdHMudWRpZFxuICAgICAgPyBwYXRoLnJlc29sdmUocHJvY2Vzcy5lbnYuSE9NRSwgJ0xpYnJhcnknLCAnTG9ncycsICdDcmFzaFJlcG9ydGVyJywgJ01vYmlsZURldmljZScpXG4gICAgICA6IHBhdGgucmVzb2x2ZShwcm9jZXNzLmVudi5IT01FLCAnTGlicmFyeScsICdMb2dzJywgJ0RpYWdub3N0aWNSZXBvcnRzJyk7XG4gICAgdGhpcy5sb2dEaXIgPSBsb2dEaXJcbiAgICAgIHx8IHBhdGgucmVzb2x2ZShwcm9jZXNzLmVudi5IT01FIHx8ICcvJywgJ0xpYnJhcnknLCAnTG9ncycsICdEaWFnbm9zdGljUmVwb3J0cycpO1xuICAgIHRoaXMucHJldkxvZ3MgPSBbXTtcbiAgICB0aGlzLmxvZ3NTaW5jZUxhc3RSZXF1ZXN0ID0gW107XG4gICAgdGhpcy5waG9uZU5hbWUgPSBudWxsO1xuICAgIHRoaXMuc2ltID0gb3B0cy5zaW07XG4gIH1cblxuICBhc3luYyBfZ2F0aGVyRnJvbVJlYWxEZXZpY2UgKCkge1xuICAgIGlmIChhd2FpdCB0aGlzLnB5aWRldmljZUNsaWVudC5hc3NlcnRFeGlzdHMoZmFsc2UpKSB7XG4gICAgICByZXR1cm4gKGF3YWl0IHRoaXMucHlpZGV2aWNlQ2xpZW50Lmxpc3RDcmFzaGVzKCkpXG4gICAgICAgIC5tYXAoKHgpID0+IGAke1JFQUxfREVWSUNFX01BR0lDfSR7TUFHSUNfU0VQfSR7eH1gKTtcbiAgICB9XG5cbiAgICBsZXQgY3Jhc2hMb2dzUm9vdCA9IHRoaXMubG9nRGlyO1xuICAgIGlmICh0aGlzLnVkaWQpIHtcbiAgICAgIHRoaXMucGhvbmVOYW1lID0gdGhpcy5waG9uZU5hbWUgfHwgYXdhaXQgdXRpbGl0aWVzLmdldERldmljZU5hbWUodGhpcy51ZGlkKTtcbiAgICAgIGNyYXNoTG9nc1Jvb3QgPSBwYXRoLnJlc29sdmUoY3Jhc2hMb2dzUm9vdCwgdGhpcy5waG9uZU5hbWUpO1xuICAgIH1cbiAgICBpZiAoIWF3YWl0IGZzLmV4aXN0cyhjcmFzaExvZ3NSb290KSkge1xuICAgICAgbG9nLmRlYnVnKGBDcmFzaCByZXBvcnRzIHJvb3QgJyR7Y3Jhc2hMb2dzUm9vdH0nIGRvZXMgbm90IGV4aXN0LiBHb3Qgbm90aGluZyB0byBnYXRoZXIuYCk7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIGNvbnN0IGZvdW5kRmlsZXMgPSBhd2FpdCBmcy5nbG9iKGAke2NyYXNoTG9nc1Jvb3R9LyoqLyouY3Jhc2hgLCB7XG4gICAgICBzdHJpY3Q6IGZhbHNlXG4gICAgfSk7XG4gICAgcmV0dXJuIGZvdW5kRmlsZXM7XG4gIH1cblxuICBhc3luYyBfZ2F0aGVyRnJvbVNpbXVsYXRvciAoKSB7XG4gICAgaWYgKCFhd2FpdCBmcy5leGlzdHModGhpcy5sb2dEaXIpKSB7XG4gICAgICBsb2cuZGVidWcoYENyYXNoIHJlcG9ydHMgcm9vdCAnJHt0aGlzLmxvZ0Rpcn0nIGRvZXMgbm90IGV4aXN0LiBHb3Qgbm90aGluZyB0byBnYXRoZXIuYCk7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIC8vIFRoZSBmaWxlIGZvcm1hdCBoYXMgYmVlbiBjaGFuZ2VkIGZyb20gJy5jcmFzaCcgdG8gJy5pcHMnIHNpbmNlIE1vbnRlcmV5LlxuICAgIGNvbnN0IGZvdW5kRmlsZXMgPSBhd2FpdCBmcy5nbG9iKGAke3RoaXMubG9nRGlyfS8qKi8qLisoY3Jhc2h8aXBzKWAsIHtcbiAgICAgIHN0cmljdDogZmFsc2VcbiAgICB9KTtcbiAgICAvLyBGb3IgU2ltdWxhdG9yIG9ubHkgaW5jbHVkZSBmaWxlcywgdGhhdCBjb250YWluIGN1cnJlbnQgVURJRFxuICAgIHJldHVybiBhd2FpdCBCLmZpbHRlcihmb3VuZEZpbGVzLCBhc3luYyAoeCkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IGZzLnJlYWRGaWxlKHgsICd1dGY4Jyk7XG4gICAgICAgIHJldHVybiBjb250ZW50LnRvVXBwZXJDYXNlKCkuaW5jbHVkZXModGhpcy5zaW0udWRpZC50b1VwcGVyQ2FzZSgpKTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBnZXRDcmFzaGVzICgpIHtcbiAgICByZXR1cm4gdGhpcy51ZGlkXG4gICAgICA/IGF3YWl0IHRoaXMuX2dhdGhlckZyb21SZWFsRGV2aWNlKClcbiAgICAgIDogYXdhaXQgdGhpcy5fZ2F0aGVyRnJvbVNpbXVsYXRvcigpO1xuICB9XG5cbiAgYXN5bmMgc3RhcnRDYXB0dXJlICgpIHtcbiAgICB0aGlzLnByZXZMb2dzID0gYXdhaXQgdGhpcy5nZXRDcmFzaGVzKCk7XG4gIH1cblxuICBhc3luYyBzdG9wQ2FwdHVyZSAoKSB7XG4gICAgLy8gbmVlZGVkIGZvciBjb25zaXN0ZW50IEFQSSB3aXRoIG90aGVyIGxvZ3NcbiAgfVxuXG4gIGFzeW5jIGdldExvZ3MgKCkge1xuICAgIGxldCBjcmFzaEZpbGVzID0gYXdhaXQgdGhpcy5nZXRDcmFzaGVzKCk7XG4gICAgbGV0IGRpZmYgPSBfLmRpZmZlcmVuY2UoY3Jhc2hGaWxlcywgdGhpcy5wcmV2TG9ncywgdGhpcy5sb2dzU2luY2VMYXN0UmVxdWVzdCk7XG4gICAgdGhpcy5sb2dzU2luY2VMYXN0UmVxdWVzdCA9IF8udW5pb24odGhpcy5sb2dzU2luY2VMYXN0UmVxdWVzdCwgZGlmZik7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuZmlsZXNUb0pTT04oZGlmZik7XG4gIH1cblxuICBhc3luYyBnZXRBbGxMb2dzICgpIHtcbiAgICBsZXQgY3Jhc2hGaWxlcyA9IGF3YWl0IHRoaXMuZ2V0Q3Jhc2hlcygpO1xuICAgIGxldCBsb2dGaWxlcyA9IF8uZGlmZmVyZW5jZShjcmFzaEZpbGVzLCB0aGlzLnByZXZMb2dzKTtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5maWxlc1RvSlNPTihsb2dGaWxlcyk7XG4gIH1cblxuICBhc3luYyBmaWxlc1RvSlNPTiAocGF0aHMpIHtcbiAgICBjb25zdCB0bXBSb290ID0gYXdhaXQgdGVtcERpci5vcGVuRGlyKCk7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiAoYXdhaXQgQi5tYXAocGF0aHMsIGFzeW5jIChmdWxsUGF0aCkgPT4ge1xuICAgICAgICBpZiAoXy5pbmNsdWRlcyhmdWxsUGF0aCwgUkVBTF9ERVZJQ0VfTUFHSUMpKSB7XG4gICAgICAgICAgY29uc3QgZmlsZU5hbWUgPSBfLmxhc3QoZnVsbFBhdGguc3BsaXQoTUFHSUNfU0VQKSk7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucHlpZGV2aWNlQ2xpZW50LmV4cG9ydENyYXNoKGZpbGVOYW1lLCB0bXBSb290KTtcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBsb2cud2FybihgQ2Fubm90IGV4cG9ydCB0aGUgY3Jhc2ggcmVwb3J0ICcke2ZpbGVOYW1lfScuIFNraXBwaW5nIGl0LiBgICtcbiAgICAgICAgICAgICAgYE9yaWdpbmFsIGVycm9yOiAke2UubWVzc2FnZX1gKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9XG4gICAgICAgICAgZnVsbFBhdGggPSBwYXRoLmpvaW4odG1wUm9vdCwgZmlsZU5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHN0YXQgPSBhd2FpdCBmcy5zdGF0KGZ1bGxQYXRoKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB0aW1lc3RhbXA6IHN0YXQuY3RpbWUuZ2V0VGltZSgpLFxuICAgICAgICAgIGxldmVsOiAnQUxMJyxcbiAgICAgICAgICBtZXNzYWdlOiBhd2FpdCBmcy5yZWFkRmlsZShmdWxsUGF0aCwgJ3V0ZjgnKVxuICAgICAgICB9O1xuICAgICAgfSkpLmZpbHRlcihCb29sZWFuKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgYXdhaXQgZnMucmltcmFmKHRtcFJvb3QpO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgeyBJT1NDcmFzaExvZyB9O1xuZXhwb3J0IGRlZmF1bHQgSU9TQ3Jhc2hMb2c7XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUEsTUFBTUEsaUJBQWlCLEdBQUcsc0NBQTFCO0FBQ0EsTUFBTUMsU0FBUyxHQUFHLEdBQWxCOztBQUdBLE1BQU1DLFdBQU4sQ0FBa0I7RUFDaEJDLFdBQVcsQ0FBRUMsSUFBSSxHQUFHLEVBQVQsRUFBYTtJQUN0QixLQUFLQyxJQUFMLEdBQVlELElBQUksQ0FBQ0MsSUFBakI7SUFDQSxLQUFLQyxlQUFMLEdBQXVCLEtBQUtELElBQUwsR0FBWSxJQUFJRSwwQkFBSixDQUFjLEtBQUtGLElBQW5CLENBQVosR0FBdUMsSUFBOUQ7SUFDQSxNQUFNRyxNQUFNLEdBQUdKLElBQUksQ0FBQ0MsSUFBTCxHQUNYSSxhQUFBLENBQUtDLE9BQUwsQ0FBYUMsT0FBTyxDQUFDQyxHQUFSLENBQVlD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